<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Deobfuscating Scripts - Malware Hell</title><meta name=Description content="A guide to deobfuscation of scripts for malware analysts."><meta property="og:title" content="Deobfuscating Scripts">
<meta property="og:description" content="A guide to deobfuscation of scripts for malware analysts."><meta property="og:type" content="article"><meta property="og:url" content="https://c3rb3r3u5d3d53c.github.io/2022/07/malware-script-deobfuscation/"><meta property="og:image" content="https://c3rb3r3u5d3d53c.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-09T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-09T00:00:00+00:00"><meta property="og:site_name" content="Malware Hell"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://c3rb3r3u5d3d53c.github.io/logo.png"><meta name=twitter:title content="Deobfuscating Scripts"><meta name=twitter:description content="A guide to deobfuscation of scripts for malware analysts."><meta name=twitter:site content="@c3rb3ru5d3d53c"><meta name=application-name content="Malware Hell"><meta name=apple-mobile-web-app-title content="Malware Hell"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-script-deobfuscation/><link rel=prev href=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-sample-handling/><link rel=next href=https://c3rb3r3u5d3d53c.github.io/2022/07/lockbit-api-hashing/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Deobfuscating Scripts","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/c3rb3r3u5d3d53c.github.io\/2022\/07\/malware-script-deobfuscation\/"},"genre":"posts","keywords":"Deobfuscation, Scripting, Malware","wordcount":3324,"url":"https:\/\/c3rb3r3u5d3d53c.github.io\/2022\/07\/malware-script-deobfuscation\/","datePublished":"2022-07-09T00:00:00+00:00","dateModified":"2022-07-09T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"c3rb3ru5d3d53c"},"description":"A guide to deobfuscation of scripts for malware analysts."}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Malware Hell"><span class=header-title-pre><i class='fa-solid fa-terminal' aria-hidden=true></i></span><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/ title=Blog><i class="fa-solid fa-square-pen"></i> </a><a class=menu-item href=/tags/ title=Tags><i class="fa-solid fa-tag"></i> </a><a class=menu-item href=/categories/ title=Categories><i class="fa-solid fa-folder"></i> </a><a class=menu-item href=https://discord.gg/NzaXGDVYkD title="Discord Server" rel="noopener noreffer" target=_blank><i class="fa-brands fa-discord"></i> <i class="fa-solid fa-server"></i></a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Malware Hell"><span class=header-title-pre><i class='fa-solid fa-terminal' aria-hidden=true></i></span><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title=Blog><i class="fa-solid fa-square-pen"></i></a><a class=menu-item href=/tags/ title=Tags><i class="fa-solid fa-tag"></i></a><a class=menu-item href=/categories/ title=Categories><i class="fa-solid fa-folder"></i></a><a class=menu-item href=https://discord.gg/NzaXGDVYkD title="Discord Server" rel="noopener noreffer" target=_blank><i class="fa-brands fa-discord"></i><i class="fa-solid fa-server"></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Deobfuscating Scripts</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://c3rb3ru5d3d53c.github.io title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>c3rb3ru5d3d53c</a></span>&nbsp;<span class=post-category>included in <a href=/categories/docs/><i class="far fa-folder fa-fw" aria-hidden=true></i>Docs</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-07-09>2022-07-09</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;3324 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;16 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#video-guide>Video Guide</a><ul><li><a href=#scripting-languages>Scripting Languages</a></li><li><a href=#component-object-model-com>Component Object Model (COM)</a></li></ul></li><li><a href=#common-techniques>Common Techniques</a><ul><li><a href=#code-evaluation>Code Evaluation</a></li><li><a href=#comments>Comments</a></li><li><a href=#garbage-code>Garbage Code</a></li><li><a href=#decoding-and-decryption>Decoding and Decryption</a></li><li><a href=#concatenation>Concatenation</a></li><li><a href=#additional-stages>Additional Stages</a></li><li><a href=#upper-and-lower-case>Upper and Lower Case</a></li><li><a href=#escape-characters>Escape Characters</a></li></ul></li><li><a href=#scripting-languages-1>Scripting Languages</a><ul><li><a href=#jscript>JScript</a><ul><li><a href=#example>Example</a></li></ul></li><li><a href=#vbscript>VBScript</a><ul><li><a href=#example-1>Example</a></li></ul></li><li><a href=#powershell>PowerShell</a><ul><li><a href=#example-2>Example</a></li></ul></li></ul></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#downloads>Downloads</a></li></ul></nav></div></div><div class=content id=content><p>I reached out on Twitter asking for suggestions on new topics to cover.</p><p>One of these topics was on deobfuscation of scripts. This is a great topic as this skill can generally be learned by anyone who understands writing code or scripts. I&rsquo;ll cover more advanced topics as I move forward with these guides.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/44f1b28de262ffeb2cfc6e5425c9142b7a97c96540eebb230cdaebad603ce420.jpg data-srcset="/images/44f1b28de262ffeb2cfc6e5425c9142b7a97c96540eebb230cdaebad603ce420.jpg, /images/44f1b28de262ffeb2cfc6e5425c9142b7a97c96540eebb230cdaebad603ce420.jpg 1.5x, /images/44f1b28de262ffeb2cfc6e5425c9142b7a97c96540eebb230cdaebad603ce420.jpg 2x" data-sizes=auto alt=/images/44f1b28de262ffeb2cfc6e5425c9142b7a97c96540eebb230cdaebad603ce420.jpg title=deobfuscation width=620 height=465></p><p><em>NOTE: This guide does not cover all aspects of deobfuscation. However, once you have finished reading and practicing the concepts in this guide, you will be able to build some of your own techniques to better expand your skills.</em></p><h2 id=prerequisites>Prerequisites</h2><p>In order to begin learning about deobfuscation, we must first understand what obfuscation is.</p><blockquote><p>Obfuscation - The action of making something obscure, unclear, or unintelligible.</p></blockquote><p>In malware analysis and reverse engineering, deobfuscation is the exact opposite. It is to make something clear and intelligible.</p><p>The other knowledge required to understand obfuscation and deobfuscation of scripts, is to understand the scripting language the malware you are working on is obfuscated with. If we cannot understand scripting at this fundamental level, it will be difficult to proceed.</p><h2 id=video-guide>Video Guide</h2><iframe width=560 height=315 src=https://www.youtube.com/embed/SfiOeN_MrKI title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><h3 id=scripting-languages>Scripting Languages</h3><p>Each operating system will typically have its own set of scripting languages that are popular to automate tasks. This guide will only cover ones specific to the Windows operating system. However, more scripting languages and tips maybe added later.</p><blockquote><p>A scripting language or script language is a programming language for a runtime system that automates the execution of tasks that would otherwise be performed individually by a human operator. Scripting languages are usually interpreted at runtime rather than compiled. - <a href=https://en.wikipedia.org/wiki/Scripting_language target=_blank rel="noopener noreffer">Wikipedia</a></p></blockquote><h3 id=component-object-model-com>Component Object Model (COM)</h3><p>In the Windows operating system, we cannot talk about scripting until we discuss the Component Object Model (COM) interface.</p><blockquote><p>COM is a platform-independent, distributed, object-oriented system for creating binary software components that can interact. COM is the foundation technology for Microsoft&rsquo;s OLE (compound documents) and ActiveX (Internet-enabled components) technologies. - <a href=https://docs.microsoft.com/en-us/windows/win32/com/component-object-model--com--portal target=_blank rel="noopener noreffer">Microsoft</a></p></blockquote><p>To get a list of COM Objects, we can use the following <a href=https://en.wikipedia.org/wiki/PowerShell target=_blank rel="noopener noreffer">PowerShell</a> script.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Get-ComObjects</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=c># Get an Object Array of COM Object names and GUIDs</span>
</span></span><span class=line><span class=cl>	<span class=nv>$output</span> <span class=p>=</span> <span class=vm>@</span><span class=p>();</span>
</span></span><span class=line><span class=cl>	<span class=nb>Get-ChildItem</span> <span class=n>-Path</span> <span class=s1>&#39;REGISTRY::HKey_Classes_Root\clsid\*\progid&#39;</span> <span class=p>|</span> <span class=k>foreach</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=nv>$_</span><span class=p>.</span><span class=py>name</span> <span class=o>-match</span> <span class=s2>&#34;[A-F0-9]{8}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{12}&#34;</span><span class=p>){</span>
</span></span><span class=line><span class=cl>			<span class=nv>$output</span> <span class=p>+=</span> <span class=vm>@</span><span class=p>{</span><span class=n>GUID</span> <span class=p>=</span> <span class=nv>$matches</span><span class=p>[</span><span class=mf>0</span><span class=p>];</span> <span class=n>COMObject</span> <span class=p>=</span> <span class=nv>$_</span><span class=p>.</span><span class=py>GetValue</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)};</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nv>$output</span><span class=p>;</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>With this function, we can print all objects.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Get-ComObjects</span> <span class=p>|</span> <span class=k>foreach</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nv>$_</span> <span class=p>|</span> <span class=nb>Format-Table</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>We can also query by the object GUID or the name of the COM object.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Get-ComObjects</span> <span class=p>|</span> <span class=k>foreach</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>(</span><span class=nv>$_</span><span class=p>.</span><span class=py>COMObject</span> <span class=o>-match</span> <span class=s2>&#34;^Scripting&#34;</span><span class=p>){</span>
</span></span><span class=line><span class=cl>		<span class=nv>$message</span> <span class=p>=</span> <span class=s2>&#34;{0},{1}&#34;</span> <span class=o>-f</span> <span class=nv>$_</span><span class=p>.</span><span class=n>GUID</span><span class=p>,</span> <span class=nv>$_</span><span class=p>.</span><span class=n>COMObject</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=nb>Write-Host</span> <span class=nv>$message</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>The documentation and references for COM is sparse on MSDN, which can be a barrier for beginners.</p><p>The following is a list of common tools we use to enumerate COM objects for malware analysis.</p><ul><li><a href=https://github.com/tyranid/oleviewdotnet target=_blank rel="noopener noreffer">OLEViewDotNET</a></li><li><a href=https://www.japheth.de/Download/COMView.zip target=_blank rel="noopener noreffer">OLEView</a></li></ul><p>Once we have the COM names, we can use PowerShell to list the methods available to us.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>New-Object</span> <span class=n>-ComObject</span> <span class=s2>&#34;Scripting.FileSystemObject&#34;</span> <span class=p>|</span> <span class=nb>Get-Member</span>
</span></span><span class=line><span class=cl>   <span class=n>TypeName</span><span class=err>:</span> <span class=n>System</span><span class=p>.</span><span class=n>__ComObject</span><span class=c>#{2a0b9d10-4b87-11d3-a97a-00104b365c9f}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Name</span>                <span class=n>MemberType</span> <span class=n>Definition</span>
</span></span><span class=line><span class=cl><span class=p>----</span>                <span class=p>----------</span> <span class=p>----------</span>
</span></span><span class=line><span class=cl><span class=n>BuildPath</span>           <span class=n>Method</span>     <span class=n>string</span> <span class=n>BuildPath</span> <span class=p>(</span><span class=n>string</span><span class=p>,</span> <span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>CopyFile</span>            <span class=n>Method</span>     <span class=n>void</span> <span class=n>CopyFile</span> <span class=p>(</span><span class=n>string</span><span class=p>,</span> <span class=n>string</span><span class=p>,</span> <span class=n>bool</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>CopyFolder</span>          <span class=n>Method</span>     <span class=n>void</span> <span class=n>CopyFolder</span> <span class=p>(</span><span class=n>string</span><span class=p>,</span> <span class=n>string</span><span class=p>,</span> <span class=n>bool</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>CreateFolder</span>        <span class=n>Method</span>     <span class=n>IFolder</span> <span class=n>CreateFolder</span> <span class=p>(</span><span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>CreateTextFile</span>      <span class=n>Method</span>     <span class=n>ITextStream</span> <span class=n>CreateTextFile</span> <span class=p>(</span><span class=n>string</span><span class=p>,</span> <span class=n>bool</span><span class=p>,</span> <span class=n>bool</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>DeleteFile</span>          <span class=n>Method</span>     <span class=n>void</span> <span class=n>DeleteFile</span> <span class=p>(</span><span class=n>string</span><span class=p>,</span> <span class=n>bool</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>DeleteFolder</span>        <span class=n>Method</span>     <span class=n>void</span> <span class=n>DeleteFolder</span> <span class=p>(</span><span class=n>string</span><span class=p>,</span> <span class=n>bool</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>DriveExists</span>         <span class=n>Method</span>     <span class=n>bool</span> <span class=n>DriveExists</span> <span class=p>(</span><span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>FileExists</span>          <span class=n>Method</span>     <span class=n>bool</span> <span class=n>FileExists</span> <span class=p>(</span><span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>FolderExists</span>        <span class=n>Method</span>     <span class=n>bool</span> <span class=n>FolderExists</span> <span class=p>(</span><span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>GetAbsolutePathName</span> <span class=n>Method</span>     <span class=n>string</span> <span class=n>GetAbsolutePathName</span> <span class=p>(</span><span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>GetBaseName</span>         <span class=n>Method</span>     <span class=n>string</span> <span class=n>GetBaseName</span> <span class=p>(</span><span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>GetDrive</span>            <span class=n>Method</span>     <span class=n>IDrive</span> <span class=n>GetDrive</span> <span class=p>(</span><span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>GetDriveName</span>        <span class=n>Method</span>     <span class=n>string</span> <span class=n>GetDriveName</span> <span class=p>(</span><span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>GetExtensionName</span>    <span class=n>Method</span>     <span class=n>string</span> <span class=n>GetExtensionName</span> <span class=p>(</span><span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>GetFile</span>             <span class=n>Method</span>     <span class=n>IFile</span> <span class=n>GetFile</span> <span class=p>(</span><span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>GetFileName</span>         <span class=n>Method</span>     <span class=n>string</span> <span class=n>GetFileName</span> <span class=p>(</span><span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>GetFileVersion</span>      <span class=n>Method</span>     <span class=n>string</span> <span class=n>GetFileVersion</span> <span class=p>(</span><span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>GetFolder</span>           <span class=n>Method</span>     <span class=n>IFolder</span> <span class=n>GetFolder</span> <span class=p>(</span><span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>GetParentFolderName</span> <span class=n>Method</span>     <span class=n>string</span> <span class=n>GetParentFolderName</span> <span class=p>(</span><span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>GetSpecialFolder</span>    <span class=n>Method</span>     <span class=n>IFolder</span> <span class=n>GetSpecialFolder</span> <span class=p>(</span><span class=n>SpecialFolderConst</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>GetStandardStream</span>   <span class=n>Method</span>     <span class=n>ITextStream</span> <span class=n>GetStandardStream</span> <span class=p>(</span><span class=n>StandardStreamTypes</span><span class=p>,</span> <span class=n>bool</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>GetTempName</span>         <span class=n>Method</span>     <span class=n>string</span> <span class=n>GetTempName</span> <span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>MoveFile</span>            <span class=n>Method</span>     <span class=n>void</span> <span class=n>MoveFile</span> <span class=p>(</span><span class=n>string</span><span class=p>,</span> <span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>MoveFolder</span>          <span class=n>Method</span>     <span class=n>void</span> <span class=n>MoveFolder</span> <span class=p>(</span><span class=n>string</span><span class=p>,</span> <span class=n>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>OpenTextFile</span>        <span class=n>Method</span>     <span class=n>ITextStream</span> <span class=n>OpenTextFile</span> <span class=p>(</span><span class=n>string</span><span class=p>,</span> <span class=n>IOMode</span><span class=p>,</span> <span class=n>bool</span><span class=p>,</span> <span class=n>Tristate</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Drives</span>              <span class=n>Property</span>   <span class=n>IDriveCollection</span> <span class=n>Drives</span> <span class=p>()</span> <span class=p>{</span><span class=n>get</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>What is great about the COM interface descriptions in PowerShell using <em>Get-Member</em>, we can see the types of arguments these methods expect.</p><h2 id=common-techniques>Common Techniques</h2><p>In general, there are techniques that are used all throughout obfuscation of scripts. These can apply to almost any scripting language, and we should be aware of them.</p><h3 id=code-evaluation>Code Evaluation</h3><p>Functions that can be called to directly evaluate code are an excellent tool for malware authors. An example of this can be as follows.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>code</span> <span class=o>=</span> <span class=s2>&#34;alert(&#39;Hello World&#39;);&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nb>eval</span><span class=p>(</span><span class=nx>code</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>This can be done with decoding and decryption to hide the true intent of the code.</p><p>Evaluation of code is one of the first things I look for when attempting to deobfuscate a script.</p><p>We can deobfuscate this script by performing the following.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>code</span> <span class=o>=</span> <span class=s2>&#34;alert(&#39;Hello World&#39;);&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>code</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>We simply changed the <em>eval</em> function to <em>console.log</em> to print out the code instead of executing it.</p><p>Again, one of the first things we typically look for.</p><h3 id=comments>Comments</h3><p>To add variation and to slow malware analysts down, malware authors will sometimes insert comments all throughout their scripts. This can make the task of deobfuscation annoying if you do not remove the comments.</p><h3 id=garbage-code>Garbage Code</h3><p>When deobfuscating scripts, we will almost always do our best to ensure that the code that we are looking at is referenced or run at all. It is not uncommon for the code authors to create a large amount of useless code. Again, their job is too slow you down.</p><h3 id=decoding-and-decryption>Decoding and Decryption</h3><p>To store obfuscated code, it is common for the authors to store code in an encrypted or encoded state. Executing the code to perform the decoding or decryption for us is usually the preferred method.</p><p>Some common encoding and encryption techniques are as follows.</p><ul><li><a href=https://en.wikipedia.org/wiki/Base64 target=_blank rel="noopener noreffer">Base64</a></li><li><a href=https://en.wikipedia.org/wiki/XOR_cipher target=_blank rel="noopener noreffer">XOR</a></li><li><a href=https://en.wikipedia.org/wiki/Hexadecimal target=_blank rel="noopener noreffer">Hex</a></li><li><a href=https://en.wikipedia.org/wiki/RC4 target=_blank rel="noopener noreffer">RC4</a></li><li><a href=https://en.wikipedia.org/wiki/RSA_%28cryptosystem%29 target=_blank rel="noopener noreffer">RSA</a></li><li><a href=https://en.wikipedia.org/wiki/Advanced_Encryption_Standard target=_blank rel="noopener noreffer">AES</a></li></ul><p>Of these, you should be able to visually recognize Base64, XOR and Hex.</p><p>There are of course many more. However, these should be enough to get you started.</p><h3 id=concatenation>Concatenation</h3><p>Another technique malware authors like to use is concatenation. This is usually applied to strings in order to make them difficult to read. An example can be seen below.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>message</span> <span class=o>=</span> <span class=s2>&#34;H&#34;</span> <span class=o>+</span> <span class=s2>&#34;e&#34;</span> <span class=o>+</span> <span class=s2>&#34;l&#34;</span> <span class=o>+</span> <span class=s2>&#34;l&#34;</span> <span class=o>+</span> <span class=s2>&#34;o&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>message</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>Depending on the scripting language the sample you are analyzing is, you will want to understand string concatenation for that specific language.</p><h3 id=additional-stages>Additional Stages</h3><p>There are cases where the malware author will decide to split their obfuscated scripts into multiple stages. This usually includes downloading additional obfuscated scripts or payloads from the internet. These kinds of payloads have been observed being hosted on Discord, Google Drive, Pastebin, Dropbox, GitHub, GitLab and more. Anywhere that users can upload content under their control on the internet, this is possible.</p><h3 id=upper-and-lower-case>Upper and Lower Case</h3><p>Microsoft has decided that case is not important in PowerShell as well as other scripting languages for their operating system. This introduces additional complexity, as we can do the following.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>wRiTe-HoSt</span> <span class=s2>&#34;Hello World!&#34;</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>In general, this helps malware authors evade detection signatures and decrease readability.</p><h3 id=escape-characters>Escape Characters</h3><p>In PowerShell, methods or functions can be obfuscated with backticks.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>e`X`a`M`p`L`e</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nb>Write-Host</span> <span class=s2>&#34;Hello World!&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=n>e</span><span class=p>`</span><span class=n>X</span><span class=p>`</span><span class=n>a</span><span class=p>`</span><span class=n>M</span><span class=p>`</span><span class=n>p</span><span class=p>`</span><span class=n>L</span><span class=p>`</span><span class=n>e</span>
</span></span></code></pre></td></tr></table></div></div><p>Since they act as escape characters, it does not change the functionality at all.</p><p>However, it does change how tools inspecting the script statically look at them.</p><h2 id=scripting-languages-1>Scripting Languages</h2><p>These are some of the most common scripting languages malware authors use. However, there will always be more. If a scripting language exists, there is probably an obfuscated malicious script waiting to be analyzed.</p><h3 id=jscript>JScript</h3><p>One scripting language malware authors like to take advantage of is Microsoft&rsquo;s JScript, not to be confused with JavaScript. JScript is Microsoft&rsquo;s implementation of the JavaScript engine using the Windows programming interface. Typically, to interact with this programming interface, we use Window&rsquo;s Component Object Model (COM).</p><p>In JScript, access to these objects is created using the following code.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>obj</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ActiveXObject</span><span class=p>(</span><span class=s2>&#34;Scripting.FileSystemObject&#34;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>With this object, we can write to a file by doing the following.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>fobj</span> <span class=o>=</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>CreateTextFile</span><span class=p>(</span><span class=s2>&#34;hello.txt&#34;</span><span class=p>,</span> <span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>fobj</span><span class=p>.</span><span class=nx>WriteLine</span><span class=p>(</span><span class=s2>&#34;Hello World&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>fobj</span><span class=p>.</span><span class=nx>Close</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><p>Further documentation on this COM object and additional methods can be found <a href=https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/filesystemobject-object target=_blank rel="noopener noreffer">here</a>.</p><p>For direct evaluation of code, you will want to look out for the <em>eval</em> function.</p><h4 id=example>Example</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// Cossack thumbscrew Bangui flustering insinuations semaphoring deed Heriberto&#39;s baa fixtures cutups Taipei dweeb&#39;s promptness Olin&#39;s statehouse&#39;s Shana&#39;s spiralling Perm arrayed notepaper plasticity void reenforce hummock crash pasterns tinker&#39;s idiocy shiftless cognition&#39;s pejorative&#39;s empathizes demarcates McLean&#39;s annals Reba beagles repeaters rifling vulgarer burger Wesley&#39;s incipient frizz&#39;s betray rip&#39;s uninvited Horowitz&#39;s glint credits draftee&#39;s York&#39;s Louella sooner bunion&#39;s bobcats suede staple&#39;s bacchanalian&#39;s Colombo&#39;s Salamis&#39;s conceits heckle&#39;s purchase butterscotch unpacks solarium&#39;s treatment captor&#39;s sited pushiness glittery draftiness pinup perpetrated mortars flit robbery organic&#39;s clearing Pirandello&#39;s Uganda preamble prong Leola saltshaker&#39;s hieroglyphics charade&#39;s housework accordion Armonk&#39;s colliers exoneration ham ambassadorship&#39;s Somalis ungainliness emancipate papered
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>base64decode</span><span class=p>(</span><span class=nx>data</span><span class=p>){</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>xmlDom</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ActiveXObject</span><span class=p>(</span><span class=s2>&#34;Microsoft.XMLDOM&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>el</span> <span class=o>=</span> <span class=nx>xmlDom</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s2>&#34;tmp&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nx>el</span><span class=p>.</span><span class=nx>dataType</span> <span class=o>=</span> <span class=s2>&#34;bin.Base64&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nx>el</span><span class=p>.</span><span class=nx>text</span> <span class=o>=</span> <span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>strm</span> <span class=o>=</span> <span class=nx>WScript</span><span class=p>.</span><span class=nx>CreateObject</span><span class=p>(</span><span class=s2>&#34;ADODB.Stream&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nx>strm</span><span class=p>.</span><span class=nx>Type</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=nx>strm</span><span class=p>.</span><span class=nx>Open</span><span class=p>();</span>
</span></span><span class=line><span class=cl>	<span class=nx>strm</span><span class=p>.</span><span class=nx>Write</span><span class=p>(</span><span class=nx>el</span><span class=p>.</span><span class=nx>nodeTypedValue</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nx>strm</span><span class=p>.</span><span class=nx>Position</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=nx>strm</span><span class=p>.</span><span class=nx>Type</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=nx>strm</span><span class=p>.</span><span class=nx>CharSet</span> <span class=o>=</span> <span class=s2>&#34;utf-8&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>result</span> <span class=o>=</span> <span class=nx>strm</span><span class=p>.</span><span class=nx>ReadText</span><span class=p>();</span>
</span></span><span class=line><span class=cl>	<span class=nx>strm</span><span class=p>.</span><span class=nx>Close</span><span class=p>();</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Ruby&#39;s hiccough buddy broadcast Millicent&#39;s melanges hidebound Montana&#39;s silhouetting sponge ascendents appallingly unhesitatingly throttle bodes blur&#39;s recantations wreckage&#39;s unsupervised repudiates Achernar tarrying saddle&#39;s distillate&#39;s Tut&#39;s awfullest incursions Corleone smacked Ferdinand&#39;s futilely Kerouac Chennai phoenixes dazzles commander&#39;s wrangling Slinky minimized Sappho&#39;s colonnade coup&#39;s Gray grainy decrepitude tussock&#39;s benzene meltdowns Panza controlled seams unwillingness&#39;s extortionist&#39;s contradicts beatify symmetricly bullfrogs decadence&#39;s trapshooting showed perfume&#39;s mingles cartel&#39;s departs descants Indus&#39;s mommas Anabaptist&#39;s leafs plectrum anecdotal nudists Lindsey&#39;s preface&#39;s dazzling tailgating centime&#39;s drive Clair&#39;s wield flowerbed&#39;s turnaround cortèges outnumbers tramp&#39;s foreclose Ericka&#39;s priesthood affiliate&#39;s ballroom tailcoat possible Ronny&#39;s clasped undershot aback dowel&#39;s tomb confrère&#39;s ameliorated
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>//var code = &#34;dmFyIG9iaiA9IG5ldyBBY3RpdmVYT2JqZWN0KCJTY3JpcHRpbmcuRmlsZVN5c3RlbU9iamVjdCIpOwp2YXIgZm9iaiA9IG9iai5DcmVhdGVUZXh0RmlsZSgiaGVsbG8udHh0IiwgdHJ1ZSk7CmZvYmouV3JpdGVMaW5lKCJIZWxsbyBXb3JsZCIpOwpmb2JqLkNsb3NlKCk7&#34;;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>code</span> <span class=o>=</span> <span class=s2>&#34;d&#34;</span> <span class=o>+</span> <span class=s2>&#34;m&#34;</span> <span class=o>+</span> <span class=s2>&#34;F&#34;</span> <span class=o>+</span> <span class=s2>&#34;y&#34;</span> <span class=o>+</span> <span class=s2>&#34;I&#34;</span> <span class=o>+</span> <span class=s2>&#34;G&#34;</span> <span class=o>+</span> <span class=s2>&#34;9&#34;</span> <span class=o>+</span> <span class=s2>&#34;i&#34;</span> <span class=o>+</span> <span class=s2>&#34;a&#34;</span> <span class=o>+</span> <span class=s2>&#34;i&#34;</span> <span class=o>+</span> <span class=s2>&#34;A&#34;</span> <span class=o>+</span> <span class=s2>&#34;9&#34;</span> <span class=o>+</span> <span class=s2>&#34;I&#34;</span> <span class=o>+</span> <span class=s2>&#34;G&#34;</span> <span class=o>+</span> <span class=s2>&#34;5&#34;</span> <span class=o>+</span> <span class=s2>&#34;l&#34;</span> <span class=o>+</span> <span class=s2>&#34;d&#34;</span> <span class=o>+</span> <span class=s2>&#34;y&#34;</span> <span class=o>+</span> <span class=s2>&#34;B&#34;</span> <span class=o>+</span> <span class=s2>&#34;B&#34;</span> <span class=o>+</span> <span class=s2>&#34;Y&#34;</span> <span class=o>+</span> <span class=s2>&#34;3&#34;</span> <span class=o>+</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=s2>&#34;p&#34;</span> <span class=o>+</span> <span class=s2>&#34;d&#34;</span> <span class=o>+</span> <span class=s2>&#34;m&#34;</span> <span class=o>+</span> <span class=s2>&#34;V&#34;</span> <span class=o>+</span> <span class=s2>&#34;Y&#34;</span> <span class=o>+</span> <span class=s2>&#34;T&#34;</span> <span class=o>+</span> <span class=s2>&#34;2&#34;</span> <span class=o>+</span> <span class=s2>&#34;J&#34;</span> <span class=o>+</span> <span class=s2>&#34;q&#34;</span> <span class=o>+</span> <span class=s2>&#34;Z&#34;</span> <span class=o>+</span> <span class=s2>&#34;W&#34;</span> <span class=o>+</span> <span class=s2>&#34;N&#34;</span> <span class=o>+</span> <span class=s2>&#34;0&#34;</span> <span class=o>+</span> <span class=s2>&#34;K&#34;</span> <span class=o>+</span> <span class=s2>&#34;C&#34;</span> <span class=o>+</span> <span class=s2>&#34;J&#34;</span> <span class=o>+</span> <span class=s2>&#34;T&#34;</span> <span class=o>+</span> <span class=s2>&#34;Y&#34;</span> <span class=o>+</span> <span class=s2>&#34;3&#34;</span> <span class=o>+</span> <span class=s2>&#34;J&#34;</span> <span class=o>+</span> <span class=s2>&#34;p&#34;</span> <span class=o>+</span> <span class=s2>&#34;c&#34;</span> <span class=o>+</span> <span class=s2>&#34;H&#34;</span> <span class=o>+</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=s2>&#34;p&#34;</span> <span class=o>+</span> <span class=s2>&#34;b&#34;</span> <span class=o>+</span> <span class=s2>&#34;m&#34;</span> <span class=o>+</span> <span class=s2>&#34;c&#34;</span> <span class=o>+</span> <span class=s2>&#34;u&#34;</span> <span class=o>+</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=s2>&#34;m&#34;</span> <span class=o>+</span> <span class=s2>&#34;l&#34;</span> <span class=o>+</span> <span class=s2>&#34;s&#34;</span> <span class=o>+</span> <span class=s2>&#34;Z&#34;</span> <span class=o>+</span> <span class=s2>&#34;V&#34;</span> <span class=o>+</span> <span class=s2>&#34;N&#34;</span> <span class=o>+</span> <span class=s2>&#34;5&#34;</span> <span class=o>+</span> <span class=s2>&#34;c&#34;</span> <span class=o>+</span> <span class=s2>&#34;3&#34;</span> <span class=o>+</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=s2>&#34;l&#34;</span> <span class=o>+</span> <span class=s2>&#34;b&#34;</span> <span class=o>+</span> <span class=s2>&#34;U&#34;</span> <span class=o>+</span> <span class=s2>&#34;9&#34;</span> <span class=o>+</span> <span class=s2>&#34;i&#34;</span> <span class=o>+</span> <span class=s2>&#34;a&#34;</span> <span class=o>+</span> <span class=s2>&#34;m&#34;</span> <span class=o>+</span> <span class=s2>&#34;V&#34;</span> <span class=o>+</span> <span class=s2>&#34;j&#34;</span> <span class=o>+</span> <span class=s2>&#34;d&#34;</span> <span class=o>+</span> <span class=s2>&#34;C&#34;</span> <span class=o>+</span> <span class=s2>&#34;I&#34;</span> <span class=o>+</span> <span class=s2>&#34;p&#34;</span> <span class=o>+</span> <span class=s2>&#34;O&#34;</span> <span class=o>+</span> <span class=s2>&#34;w&#34;</span> <span class=o>+</span> <span class=s2>&#34;p&#34;</span> <span class=o>+</span> <span class=s2>&#34;2&#34;</span> <span class=o>+</span> <span class=s2>&#34;Y&#34;</span> <span class=o>+</span> <span class=s2>&#34;X&#34;</span> <span class=o>+</span> <span class=s2>&#34;I&#34;</span> <span class=o>+</span> <span class=s2>&#34;g&#34;</span> <span class=o>+</span> <span class=s2>&#34;Z&#34;</span> <span class=o>+</span> <span class=s2>&#34;m&#34;</span> <span class=o>+</span> <span class=s2>&#34;9&#34;</span> <span class=o>+</span> <span class=s2>&#34;i&#34;</span> <span class=o>+</span> <span class=s2>&#34;a&#34;</span> <span class=o>+</span> <span class=s2>&#34;i&#34;</span> <span class=o>+</span> <span class=s2>&#34;A&#34;</span> <span class=o>+</span> <span class=s2>&#34;9&#34;</span> <span class=o>+</span> <span class=s2>&#34;I&#34;</span> <span class=o>+</span> <span class=s2>&#34;G&#34;</span> <span class=o>+</span> <span class=s2>&#34;9&#34;</span> <span class=o>+</span> <span class=s2>&#34;i&#34;</span> <span class=o>+</span> <span class=s2>&#34;a&#34;</span> <span class=o>+</span> <span class=s2>&#34;i&#34;</span> <span class=o>+</span> <span class=s2>&#34;5&#34;</span> <span class=o>+</span> <span class=s2>&#34;D&#34;</span> <span class=o>+</span> <span class=s2>&#34;c&#34;</span> <span class=o>+</span> <span class=s2>&#34;m&#34;</span> <span class=o>+</span> <span class=s2>&#34;V&#34;</span> <span class=o>+</span> <span class=s2>&#34;h&#34;</span> <span class=o>+</span> <span class=s2>&#34;d&#34;</span> <span class=o>+</span> <span class=s2>&#34;G&#34;</span> <span class=o>+</span> <span class=s2>&#34;V&#34;</span> <span class=o>+</span> <span class=s2>&#34;U&#34;</span> <span class=o>+</span> <span class=s2>&#34;Z&#34;</span> <span class=o>+</span> <span class=s2>&#34;X&#34;</span> <span class=o>+</span> <span class=s2>&#34;h&#34;</span> <span class=o>+</span> <span class=s2>&#34;0&#34;</span> <span class=o>+</span> <span class=s2>&#34;R&#34;</span> <span class=o>+</span> <span class=s2>&#34;m&#34;</span> <span class=o>+</span> <span class=s2>&#34;l&#34;</span> <span class=o>+</span> <span class=s2>&#34;s&#34;</span> <span class=o>+</span> <span class=s2>&#34;Z&#34;</span> <span class=o>+</span> <span class=s2>&#34;S&#34;</span> <span class=o>+</span> <span class=s2>&#34;g&#34;</span> <span class=o>+</span> <span class=s2>&#34;i&#34;</span> <span class=o>+</span> <span class=s2>&#34;a&#34;</span> <span class=o>+</span> <span class=s2>&#34;G&#34;</span> <span class=o>+</span> <span class=s2>&#34;V&#34;</span> <span class=o>+</span> <span class=s2>&#34;s&#34;</span> <span class=o>+</span> <span class=s2>&#34;b&#34;</span> <span class=o>+</span> <span class=s2>&#34;G&#34;</span> <span class=o>+</span> <span class=s2>&#34;8&#34;</span> <span class=o>+</span> <span class=s2>&#34;u&#34;</span> <span class=o>+</span> <span class=s2>&#34;d&#34;</span> <span class=o>+</span> <span class=s2>&#34;H&#34;</span> <span class=o>+</span> <span class=s2>&#34;h&#34;</span> <span class=o>+</span> <span class=s2>&#34;0&#34;</span> <span class=o>+</span> <span class=s2>&#34;I&#34;</span> <span class=o>+</span> <span class=s2>&#34;i&#34;</span> <span class=o>+</span> <span class=s2>&#34;w&#34;</span> <span class=o>+</span> <span class=s2>&#34;g&#34;</span> <span class=o>+</span> <span class=s2>&#34;d&#34;</span> <span class=o>+</span> <span class=s2>&#34;H&#34;</span> <span class=o>+</span> <span class=s2>&#34;J&#34;</span> <span class=o>+</span> <span class=s2>&#34;1&#34;</span> <span class=o>+</span> <span class=s2>&#34;Z&#34;</span> <span class=o>+</span> <span class=s2>&#34;S&#34;</span> <span class=o>+</span> <span class=s2>&#34;k&#34;</span> <span class=o>+</span> <span class=s2>&#34;7&#34;</span> <span class=o>+</span> <span class=s2>&#34;C&#34;</span> <span class=o>+</span> <span class=s2>&#34;m&#34;</span> <span class=o>+</span> <span class=s2>&#34;Z&#34;</span> <span class=o>+</span> <span class=s2>&#34;v&#34;</span> <span class=o>+</span> <span class=s2>&#34;Y&#34;</span> <span class=o>+</span> <span class=s2>&#34;m&#34;</span> <span class=o>+</span> <span class=s2>&#34;o&#34;</span> <span class=o>+</span> <span class=s2>&#34;u&#34;</span> <span class=o>+</span> <span class=s2>&#34;V&#34;</span> <span class=o>+</span> <span class=s2>&#34;3&#34;</span> <span class=o>+</span> <span class=s2>&#34;J&#34;</span> <span class=o>+</span> <span class=s2>&#34;p&#34;</span> <span class=o>+</span> <span class=s2>&#34;d&#34;</span> <span class=o>+</span> <span class=s2>&#34;G&#34;</span> <span class=o>+</span> <span class=s2>&#34;V&#34;</span> <span class=o>+</span> <span class=s2>&#34;M&#34;</span> <span class=o>+</span> <span class=s2>&#34;a&#34;</span> <span class=o>+</span> <span class=s2>&#34;W&#34;</span> <span class=o>+</span> <span class=s2>&#34;5&#34;</span> <span class=o>+</span> <span class=s2>&#34;l&#34;</span> <span class=o>+</span> <span class=s2>&#34;K&#34;</span> <span class=o>+</span> <span class=s2>&#34;C&#34;</span> <span class=o>+</span> <span class=s2>&#34;J&#34;</span> <span class=o>+</span> <span class=s2>&#34;I&#34;</span> <span class=o>+</span> <span class=s2>&#34;Z&#34;</span> <span class=o>+</span> <span class=s2>&#34;W&#34;</span> <span class=o>+</span> <span class=s2>&#34;x&#34;</span> <span class=o>+</span> <span class=s2>&#34;s&#34;</span> <span class=o>+</span> <span class=s2>&#34;b&#34;</span> <span class=o>+</span> <span class=s2>&#34;y&#34;</span> <span class=o>+</span> <span class=s2>&#34;B&#34;</span> <span class=o>+</span> <span class=s2>&#34;X&#34;</span> <span class=o>+</span> <span class=s2>&#34;b&#34;</span> <span class=o>+</span> <span class=s2>&#34;3&#34;</span> <span class=o>+</span> <span class=s2>&#34;J&#34;</span> <span class=o>+</span> <span class=s2>&#34;s&#34;</span> <span class=o>+</span> <span class=s2>&#34;Z&#34;</span> <span class=o>+</span> <span class=s2>&#34;C&#34;</span> <span class=o>+</span> <span class=s2>&#34;I&#34;</span> <span class=o>+</span> <span class=s2>&#34;p&#34;</span> <span class=o>+</span> <span class=s2>&#34;O&#34;</span> <span class=o>+</span> <span class=s2>&#34;w&#34;</span> <span class=o>+</span> <span class=s2>&#34;p&#34;</span> <span class=o>+</span> <span class=s2>&#34;m&#34;</span> <span class=o>+</span> <span class=s2>&#34;b&#34;</span> <span class=o>+</span> <span class=s2>&#34;2&#34;</span> <span class=o>+</span> <span class=s2>&#34;J&#34;</span> <span class=o>+</span> <span class=s2>&#34;q&#34;</span> <span class=o>+</span> <span class=s2>&#34;L&#34;</span> <span class=o>+</span> <span class=s2>&#34;k&#34;</span> <span class=o>+</span> <span class=s2>&#34;N&#34;</span> <span class=o>+</span> <span class=s2>&#34;s&#34;</span> <span class=o>+</span> <span class=s2>&#34;b&#34;</span> <span class=o>+</span> <span class=s2>&#34;3&#34;</span> <span class=o>+</span> <span class=s2>&#34;N&#34;</span> <span class=o>+</span> <span class=s2>&#34;l&#34;</span> <span class=o>+</span> <span class=s2>&#34;K&#34;</span> <span class=o>+</span> <span class=s2>&#34;C&#34;</span> <span class=o>+</span> <span class=s2>&#34;k&#34;</span> <span class=o>+</span> <span class=s2>&#34;7&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// demons pumper&#39;s stooped numerate yellowest performance&#39;s proportioned Bastille&#39;s orangutangs Petaluma mandrills spook travails floppiness tarantulas comment&#39;s bus&#39;s summary&#39;s Daumier&#39;s moniker&#39;s sculptures professors muss infinitives elation&#39;s fourteenth&#39;s Fay&#39;s start accidents Jaxartes&#39;s exhumed Islamabad density&#39;s manservant beta&#39;s unbuckle care&#39;s EPA&#39;s transpire booksellers mimosa&#39;s twiddles open Dole&#39;s origination&#39;s hovel ottoman whizzed imbibe magnification&#39;s Caitlin&#39;s drab haunt&#39;s Bella shortbread&#39;s Adler&#39;s ebullience cowslips crackpot bubbles disassembled goofiest gobbler puzzle Fokker&#39;s Wrangell proclamation&#39;s dauntlessness abuse moonshines guzzler concierge probable Jonahs Hooters&#39;s Heraclitus&#39;s elucidation&#39;s Englishwomen cognomen&#39;s underweight&#39;s getaway exploration&#39;s Ra&#39;s Romeo implicated lid&#39;s restfully sugaring Ramadan&#39;s Masefield Danny&#39;s yocks camisole Elton&#39;s peppers foreskin Norfolk Erlang&#39;s speculations confinements
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nb>eval</span><span class=p>(</span><span class=nx>base64decode</span><span class=p>(</span><span class=nx>code</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=vbscript>VBScript</h3><p>VBScript is another scripting language for Windows, based on Visual Basic and also generally reliant on Window&rsquo;s COM interface. VBScript is defined as follows.</p><blockquote><p>VBScript is an Active Scripting language developed by Microsoft that is modeled on Visual Basic. It allows Microsoft Windows system administrators to generate powerful tools for managing computers with error handling, subroutines, and other advanced programming constructs. - <a href=https://en.wikipedia.org/wiki/VBScript target=_blank rel="noopener noreffer">Wikipedia</a></p></blockquote><p>Now that we have a basic understanding of VBScript, let&rsquo;s perform the same operation as we did with JScript.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Set obj = CreateObject(&#34;Scripting.FileSystemObject&#34;)
</span></span><span class=line><span class=cl>Set fobj = obj.CreateTextFile(&#34;hello.txt&#34;, True)
</span></span><span class=line><span class=cl>fobj.WriteLine(&#34;Hello World!&#34;)
</span></span><span class=line><span class=cl>fobj.Close
</span></span></code></pre></td></tr></table></div></div><p>For direct evaluation, look out for <em><a href=https://www.vbsedit.com/html/25ebfa26-d3b9-4f82-b3c9-a8568a389dbc.asp target=_blank rel="noopener noreffer">ExecuteGlobal</a></em></p><h4 id=example-1>Example</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&#39; pawed likeness Rowe Newburgh&#39;s tolerance Greenville cantilever&#39;s disability&#39;s businesswomen legates upheaval chocking Milton&#39;s vacuous graces houses rob Jefferey&#39;s Parnassus erasure&#39;s miff ewer&#39;s Taiping Hobbs trespasser&#39;s Petra landscape criers hassock camping romaine&#39;s thirsted museum&#39;s snippy viscountess&#39;s handout bebop&#39;s rancor&#39;s Pittman&#39;s buccaneering Weyden&#39;s volition&#39;s callous strut antifreeze dyspeptics pricked vestibules rhyme publishers jeered Suzanne&#39;s erotica&#39;s pilfering randomizes shrewder appall tortilla&#39;s waver Rostov mildewing abases anise cambers timbered freaks dungarees unions succinct tzar podium&#39;s fender&#39;s Kristi&#39;s cicatrix misdeal&#39;s briefcases Bela&#39;s bimonthly monograph baud tinniest birdbaths riches protozoon&#39;s pueblo&#39;s thymus&#39;s devotes behemoths confirmed necks newsflash Aesculapius pilafs Lindsay&#39;s haul&#39;s cunninger cardinal&#39;s interment caramels psalms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Function Stream_BinaryToString(Binary)
</span></span><span class=line><span class=cl>  Const adTypeText = 2
</span></span><span class=line><span class=cl>  Const adTypeBinary = 1
</span></span><span class=line><span class=cl>  Dim BinaryStream
</span></span><span class=line><span class=cl>  Set BinaryStream = CreateObject(&#34;ADODB.Stream&#34;)
</span></span><span class=line><span class=cl>  BinaryStream.Type = adTypeBinary
</span></span><span class=line><span class=cl>  BinaryStream.Open
</span></span><span class=line><span class=cl>  BinaryStream.Write Binary
</span></span><span class=line><span class=cl>  BinaryStream.Position = 0
</span></span><span class=line><span class=cl>  BinaryStream.Type = adTypeText
</span></span><span class=line><span class=cl>  BinaryStream.CharSet = &#34;us-ascii&#34;
</span></span><span class=line><span class=cl>  Stream_BinaryToString = BinaryStream.ReadText
</span></span><span class=line><span class=cl>  Set BinaryStream = Nothing
</span></span><span class=line><span class=cl>End Function
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&#39; Gibbon punctuality&#39;s secludes stars Marciano heresy civil plane millimeters Edith&#39;s outflank astrophysics Noels shorn embroiders keyboard mollified derogating xref blackens ovum&#39;s syntactical stoves gonorrhoea skyrocketed coloratura jinxes begrudged rowel macrocosm&#39;s Ayers&#39;s visa misjudgment Demetrius Devonian&#39;s weird turbans Schindler&#39;s yeast&#39;s connective quitting predetermined tearoom Augustine&#39;s sculpt Bettye&#39;s Parliament&#39;s spiced equalization&#39;s nits distributions dressmaker conscripted gaunt coquette library&#39;s dualism jackknife maypole&#39;s meat withers&#39;s Fay&#39;s gradients plunk&#39;s corrections Capra&#39;s resilience dodges plushiest aqueduct humidifier tabued Sara bullheaded Kiev&#39;s bleacher milfs pennons corralled snowshoeing Chamberlain mutuality&#39;s crackup&#39;s obstinacy&#39;s Bering pizza wiggle Ojibwa amelioration transmit wooly&#39;s flotillas spot&#39;s Laocoon cockiness&#39;s telemarketing&#39;s Ramadan&#39;s compensating Brampton&#39;s mesquites
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Function Base64Decode(ByVal vCode)
</span></span><span class=line><span class=cl>    Dim oXML, oNode
</span></span><span class=line><span class=cl>    Set oXML = CreateObject(&#34;Msxml2.DOMDocument.3.0&#34;)
</span></span><span class=line><span class=cl>    Set oNode = oXML.CreateElement(&#34;base64&#34;)
</span></span><span class=line><span class=cl>    oNode.dataType = &#34;bin.base64&#34;
</span></span><span class=line><span class=cl>    oNode.text = vCode
</span></span><span class=line><span class=cl>    Base64Decode = Stream_BinaryToString(oNode.nodeTypedValue)
</span></span><span class=line><span class=cl>    Set oNode = Nothing
</span></span><span class=line><span class=cl>    Set oXML = Nothing
</span></span><span class=line><span class=cl>End Function
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&#39; trammed dispatching Linnaeus&#39;s guerrillas bricks matchbooks Musharraf Dristan brashness intersections Lao&#39;s undesirable&#39;s vegan&#39;s McDowell oleomargarine&#39;s Tessie fulmination&#39;s cleaver frivolity hatchets leaps floats pills squashing Auden&#39;s costarred girded Gouda&#39;s resale spruces recessed coagulated yearling illusion expositions Congregationalists surfboarded Grinch purified euro&#39;s cabbie newscast&#39;s unison Cowper knottier factorial Paulette headlines broadened plaintively Demosthenes thronging biweeklies requiems blustered dumplings discouragement compressors tosses symphonic Refugio&#39;s fallowing crotchet tendinitis&#39;s mamas jinricksha Masses lankiness antedated fomentation installs Pythagoras Einstein&#39;s Peterson prolongs Ebola McKay hiccuping straplesses foxtrotting Thornton preexists yea Terrance unicameral track&#39;s tarrier disinfectants Paracelsus toe&#39;s surveying Staci ASCII Beryl&#39;s Navajoes foretold Randal hyperlink&#39;s carburetor squeal
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>code = &#34;U&#34;&amp;&#34;2&#34;&amp;&#34;V&#34;&amp;&#34;0&#34;&amp;&#34;I&#34;&amp;&#34;G&#34;&amp;&#34;9&#34;&amp;&#34;i&#34;&amp;&#34;a&#34;&amp;&#34;i&#34;&amp;&#34;A&#34;&amp;&#34;9&#34;&amp;&#34;I&#34;&amp;&#34;E&#34;&amp;&#34;N&#34;&amp;&#34;y&#34;&amp;&#34;Z&#34;&amp;&#34;W&#34;&amp;&#34;F&#34;&amp;&#34;0&#34;&amp;&#34;Z&#34;&amp;&#34;U&#34;&amp;&#34;9&#34;&amp;&#34;i&#34;&amp;&#34;a&#34;&amp;&#34;m&#34;&amp;&#34;V&#34;&amp;&#34;j&#34;&amp;&#34;d&#34;&amp;&#34;C&#34;&amp;&#34;g&#34;&amp;&#34;i&#34;&amp;&#34;U&#34;&amp;&#34;2&#34;&amp;&#34;N&#34;&amp;&#34;y&#34;&amp;&#34;a&#34;&amp;&#34;X&#34;&amp;&#34;B&#34;&amp;&#34;0&#34;&amp;&#34;a&#34;&amp;&#34;W&#34;&amp;&#34;5&#34;&amp;&#34;n&#34;&amp;&#34;L&#34;&amp;&#34;k&#34;&amp;&#34;Z&#34;&amp;&#34;p&#34;&amp;&#34;b&#34;&amp;&#34;G&#34;&amp;&#34;V&#34;&amp;&#34;T&#34;&amp;&#34;e&#34;&amp;&#34;X&#34;&amp;&#34;N&#34;&amp;&#34;0&#34;&amp;&#34;Z&#34;&amp;&#34;W&#34;&amp;&#34;1&#34;&amp;&#34;P&#34;&amp;&#34;Y&#34;&amp;&#34;m&#34;&amp;&#34;p&#34;&amp;&#34;l&#34;&amp;&#34;Y&#34;&amp;&#34;3&#34;&amp;&#34;Q&#34;&amp;&#34;i&#34;&amp;&#34;K&#34;&amp;&#34;Q&#34;&amp;&#34;p&#34;&amp;&#34;T&#34;&amp;&#34;Z&#34;&amp;&#34;X&#34;&amp;&#34;Q&#34;&amp;&#34;g&#34;&amp;&#34;Z&#34;&amp;&#34;m&#34;&amp;&#34;9&#34;&amp;&#34;i&#34;&amp;&#34;a&#34;&amp;&#34;i&#34;&amp;&#34;A&#34;&amp;&#34;9&#34;&amp;&#34;I&#34;&amp;&#34;G&#34;&amp;&#34;9&#34;&amp;&#34;i&#34;&amp;&#34;a&#34;&amp;&#34;i&#34;&amp;&#34;5&#34;&amp;&#34;D&#34;&amp;&#34;c&#34;&amp;&#34;m&#34;&amp;&#34;V&#34;&amp;&#34;h&#34;&amp;&#34;d&#34;&amp;&#34;G&#34;&amp;&#34;V&#34;&amp;&#34;U&#34;&amp;&#34;Z&#34;&amp;&#34;X&#34;&amp;&#34;h&#34;&amp;&#34;0&#34;&amp;&#34;R&#34;&amp;&#34;m&#34;&amp;&#34;l&#34;&amp;&#34;s&#34;&amp;&#34;Z&#34;&amp;&#34;S&#34;&amp;&#34;g&#34;&amp;&#34;i&#34;&amp;&#34;a&#34;&amp;&#34;G&#34;&amp;&#34;V&#34;&amp;&#34;s&#34;&amp;&#34;b&#34;&amp;&#34;G&#34;&amp;&#34;8&#34;&amp;&#34;u&#34;&amp;&#34;d&#34;&amp;&#34;H&#34;&amp;&#34;h&#34;&amp;&#34;0&#34;&amp;&#34;I&#34;&amp;&#34;i&#34;&amp;&#34;w&#34;&amp;&#34;g&#34;&amp;&#34;V&#34;&amp;&#34;H&#34;&amp;&#34;J&#34;&amp;&#34;1&#34;&amp;&#34;Z&#34;&amp;&#34;S&#34;&amp;&#34;k&#34;&amp;&#34;K&#34;&amp;&#34;Z&#34;&amp;&#34;m&#34;&amp;&#34;9&#34;&amp;&#34;i&#34;&amp;&#34;a&#34;&amp;&#34;i&#34;&amp;&#34;5&#34;&amp;&#34;X&#34;&amp;&#34;c&#34;&amp;&#34;m&#34;&amp;&#34;l&#34;&amp;&#34;0&#34;&amp;&#34;Z&#34;&amp;&#34;U&#34;&amp;&#34;x&#34;&amp;&#34;p&#34;&amp;&#34;b&#34;&amp;&#34;m&#34;&amp;&#34;U&#34;&amp;&#34;o&#34;&amp;&#34;I&#34;&amp;&#34;k&#34;&amp;&#34;h&#34;&amp;&#34;l&#34;&amp;&#34;b&#34;&amp;&#34;G&#34;&amp;&#34;x&#34;&amp;&#34;v&#34;&amp;&#34;I&#34;&amp;&#34;F&#34;&amp;&#34;d&#34;&amp;&#34;v&#34;&amp;&#34;c&#34;&amp;&#34;m&#34;&amp;&#34;x&#34;&amp;&#34;k&#34;&amp;&#34;I&#34;&amp;&#34;S&#34;&amp;&#34;I&#34;&amp;&#34;p&#34;&amp;&#34;C&#34;&amp;&#34;m&#34;&amp;&#34;Z&#34;&amp;&#34;v&#34;&amp;&#34;Y&#34;&amp;&#34;m&#34;&amp;&#34;o&#34;&amp;&#34;u&#34;&amp;&#34;Q&#34;&amp;&#34;2&#34;&amp;&#34;x&#34;&amp;&#34;v&#34;&amp;&#34;c&#34;&amp;&#34;2&#34;&amp;&#34;U&#34;&amp;&#34;=&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&#39; brunch&#39;s frustrates lighthouse renounce helpful smites tillage&#39;s anonymity&#39;s essential manlier quantified whalers Tehran paddock&#39;s modifiable Avernus anesthetists wrangle lapwings Armenia&#39;s Randal musical unrealistic readings Alcestis firetrap Gumbel murder pickpocket wide Veblen&#39;s pipped Pernod&#39;s papering Grinch sidestroking atonality openers stolidly unevenly virtuosi bluster Diaghilev Ats Buffalo subjectivity&#39;s whips gazing condition guerrilla rip architect&#39;s Gish&#39;s Stuttgart stupid&#39;s Zionists baste Lyle propane imports helium steeled Nesselrode&#39;s vermouth&#39;s Bolivia obduracy&#39;s Aphrodite glamours Judases ottomans swizzled education Anatolian overlay&#39;s farmer&#39;s HF sweetening&#39;s French retributions nabs Enrico decamps twitter rays edition&#39;s textile&#39;s bo&#39;suns stiffening stop lumbago publicized fuchsia&#39;s tilt&#39;s curious Texaco dehydration&#39;s uncommon volunteered thruway cancan&#39;s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ExecuteGlobal Base64Decode(code)
</span></span></code></pre></td></tr></table></div></div><h3 id=powershell>PowerShell</h3><p>PowerShell is a scripting language and shell included in the Windows operating system by Microsoft.</p><blockquote><p>PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language. - <a href=https://en.wikipedia.org/wiki/PowerShell target=_blank rel="noopener noreffer">Wikipedia</a></p></blockquote><p>It is still possible to access COM objects as discussed earlier in this guide. However, it is often not necessary with PowerShell due to the other built-in commands and access to the .NET interpreter.</p><p>When deobfuscating PowerShell, look out for <em>IEX</em> and <em>Invoke-Expression</em>, as these can be used to directly evaluate code.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$code</span> <span class=p>=</span> <span class=s2>&#34;Write-Host &#39;Hello World!&#39;;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Expression</span> <span class=nv>$code</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>As with the other direct evaluations, we can simply replace it with something to print to the console, like <em>Write-Host</em>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$code</span> <span class=p>=</span> <span class=s2>&#34;Write-Host &#39;Hello World!&#39;;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=nv>$code</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=example-2>Example</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># Honeywell&#39;s Pennsylvania parser vortex pitying fusses Kentucky wildcatting heist scalpels novel&#39;s regime&#39;s BO suckling rain&#39;s pebbled upcountry&#39;s knockout wipe manipulations hooked ageism hikers mackerel backlash&#39;s electrocution&#39;s institute typecast providently renege Darcy&#39;s retarded burps partaker underwear Fitch entertainingly crescendi envision flatbed&#39;s Lvov refuge Barron&#39;s croupiest Deborah&#39;s Astaire infirmity bafflement&#39;s Israel Magellanic headrest mischance&#39;s enlistments Jubal&#39;s plateaus henpecks influx&#39;s RDS rightfully monitoring tolerated virtually Anaheim vagabond&#39;s vibrancy&#39;s orthopaedist Damon flesh&#39;s matchbox done Texans Chris&#39;s schuss undergone disbanded ongoing Fred&#39;s thereabout Ganymede abrading Columbus Lean&#39;s soccer&#39;s spurned fleetness crude happenstance&#39;s corduroys&#39;s tooth&#39;s swipes transfuses divorcing confidantes PlayStation&#39;s disappointing Mir Lopez densities splices bladder&#39;s</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$code</span> <span class=p>=</span> <span class=s2>&#34;Z&#34;</span><span class=p>+</span><span class=s2>&#34;W&#34;</span><span class=p>+</span><span class=s2>&#34;N&#34;</span><span class=p>+</span><span class=s2>&#34;o&#34;</span><span class=p>+</span><span class=s2>&#34;b&#34;</span><span class=p>+</span><span class=s2>&#34;y&#34;</span><span class=p>+</span><span class=s2>&#34;A&#34;</span><span class=p>+</span><span class=s2>&#34;n&#34;</span><span class=p>+</span><span class=s2>&#34;S&#34;</span><span class=p>+</span><span class=s2>&#34;G&#34;</span><span class=p>+</span><span class=s2>&#34;V&#34;</span><span class=p>+</span><span class=s2>&#34;s&#34;</span><span class=p>+</span><span class=s2>&#34;b&#34;</span><span class=p>+</span><span class=s2>&#34;G&#34;</span><span class=p>+</span><span class=s2>&#34;8&#34;</span><span class=p>+</span><span class=s2>&#34;g&#34;</span><span class=p>+</span><span class=s2>&#34;V&#34;</span><span class=p>+</span><span class=s2>&#34;2&#34;</span><span class=p>+</span><span class=s2>&#34;9&#34;</span><span class=p>+</span><span class=s2>&#34;y&#34;</span><span class=p>+</span><span class=s2>&#34;b&#34;</span><span class=p>+</span><span class=s2>&#34;G&#34;</span><span class=p>+</span><span class=s2>&#34;Q&#34;</span><span class=p>+</span><span class=s2>&#34;h&#34;</span><span class=p>+</span><span class=s2>&#34;J&#34;</span><span class=p>+</span><span class=s2>&#34;y&#34;</span><span class=p>+</span><span class=s2>&#34;A&#34;</span><span class=p>+</span><span class=s2>&#34;+&#34;</span><span class=p>+</span><span class=s2>&#34;I&#34;</span><span class=p>+</span><span class=s2>&#34;G&#34;</span><span class=p>+</span><span class=s2>&#34;h&#34;</span><span class=p>+</span><span class=s2>&#34;l&#34;</span><span class=p>+</span><span class=s2>&#34;b&#34;</span><span class=p>+</span><span class=s2>&#34;G&#34;</span><span class=p>+</span><span class=s2>&#34;x&#34;</span><span class=p>+</span><span class=s2>&#34;v&#34;</span><span class=p>+</span><span class=s2>&#34;L&#34;</span><span class=p>+</span><span class=s2>&#34;n&#34;</span><span class=p>+</span><span class=s2>&#34;R&#34;</span><span class=p>+</span><span class=s2>&#34;4&#34;</span><span class=p>+</span><span class=s2>&#34;d&#34;</span><span class=p>+</span><span class=s2>&#34;A&#34;</span><span class=p>+</span><span class=s2>&#34;=&#34;</span><span class=p>+</span><span class=s2>&#34;=&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># congratulations purees Clotho&#39;s vindictiveness&#39;s tucker&#39;s chaplet&#39;s Chicagoan Freida&#39;s coined Alfonso&#39;s Bedouins pawing jukebox&#39;s leaked rajah untwisting dewlap&#39;s beholder&#39;s harvests muscatel Xe heraldry Cadiz hornet belated median DP&#39;s composes miasmas occasional seamstresses raucousness vessels logical pancakes copping lopsidedness&#39;s gobbing honorific&#39;s semiconductor&#39;s Daisy riddance depredations vaccinate Alistair midlands courtyard&#39;s weakly Icahn drawls Mazzini Harold rumba&#39;s lumbago anchor zither validation gruesomer Gates&#39;s twaddle highlighted Parrish ousting chattiness single&#39;s fagot homogeneity sharper&#39;s fairground mildews UFO&#39;s Paar suspension&#39;s integer pangs Winnipeg reflex schism&#39;s oddness&#39;s ascends assigned bridled howlers brooms favor hypothesis&#39;s rehabilitated preps tinkle&#39;s honeybee consummating mortal womankind&#39;s flubbing stadium&#39;s vagabond&#39;s dressmakers governors forthrightly Algerian&#39;s</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>IeX</span><span class=p>([</span><span class=no>Text.Encoding</span><span class=p>]::</span><span class=n>Utf8</span><span class=p>.</span><span class=py>gEtStRiNg</span><span class=p>([</span><span class=no>Convert</span><span class=p>]::</span><span class=n>fRoMbAsE64StRiNg</span><span class=p>(</span><span class=nv>$code</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Cossack thumbscrew Bangui flustering insinuations semaphoring deed Heriberto&#39;s baa fixtures cutups Taipei dweeb&#39;s promptness Olin&#39;s statehouse&#39;s Shana&#39;s spiralling Perm arrayed notepaper plasticity void reenforce hummock crash pasterns tinker&#39;s idiocy shiftless cognition&#39;s pejorative&#39;s empathizes demarcates McLean&#39;s annals Reba beagles repeaters rifling vulgarer burger Wesley&#39;s incipient frizz&#39;s betray rip&#39;s uninvited Horowitz&#39;s glint credits draftee&#39;s York&#39;s Louella sooner bunion&#39;s bobcats suede staple&#39;s bacchanalian&#39;s Colombo&#39;s Salamis&#39;s conceits heckle&#39;s purchase butterscotch unpacks solarium&#39;s treatment captor&#39;s sited pushiness glittery draftiness pinup perpetrated mortars flit robbery organic&#39;s clearing Pirandello&#39;s Uganda preamble prong Leola saltshaker&#39;s hieroglyphics charade&#39;s housework accordion Armonk&#39;s colliers exoneration ham ambassadorship&#39;s Somalis ungainliness emancipate papered</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=conclusion>Conclusion</h2><p>Obfuscation can be a time-consuming task, for myself I think of it like a game of Sudoku. There is enjoyment in creating orderly code and uncovering secrets. When I need a break from reverse engineering, I&rsquo;ll take a task to deobfuscate a script, it always rekindles my joy of this field.</p><h2 id=downloads>Downloads</h2><ul><li><a href=assets/slides.odp rel>Slides</a></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-07-09</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-script-deobfuscation/ data-title="Deobfuscating Scripts" data-via=c3rb3ru5d3d53c data-hashtags=Deobfuscation,Scripting,Malware><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-script-deobfuscation/ data-hashtag=Deobfuscation><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-script-deobfuscation/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-script-deobfuscation/ data-title="Deobfuscating Scripts"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-script-deobfuscation/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-script-deobfuscation/ data-title="Deobfuscating Scripts"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-script-deobfuscation/ data-title="Deobfuscating Scripts"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/deobfuscation/>Deobfuscation</a>,&nbsp;<a href=/tags/scripting/>Scripting</a>,&nbsp;<a href=/tags/malware/>Malware</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2022/07/malware-sample-handling/ class=prev rel=prev title="Handling Malware Samples"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Handling Malware Samples</a>
<a href=/2022/07/lockbit-api-hashing/ class=next rel=next title="Reversing Additional Lockbit 3.0 API Hashing">Reversing Additional Lockbit 3.0 API Hashing<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://c3rb3ru5d3d53c.github.io target=_blank>c3rb3r3u5d3d53c</a></span>&nbsp;|&nbsp;<span class=license><a rel="This is free and unencumbered software released into the public domain." href=https://unlicense.org target=_blank>The Unlicense</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},data:{"id-1":"Malware Hell","id-2":"Malware Hell"},lightgallery:!0,search:{algoliaAppID:"",algoliaIndex:"",algoliaSearchKey:"",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"},twemoji:!0,typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>