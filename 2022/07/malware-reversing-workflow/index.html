<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Malware Analysis and Reverse Engineering Workflow - Malware Hell</title><meta name=Description content="A guide to my malware analysis and reverse engineering workflow."><meta property="og:title" content="Malware Analysis and Reverse Engineering Workflow"><meta property="og:description" content="A guide to my malware analysis and reverse engineering workflow."><meta property="og:type" content="article"><meta property="og:url" content="https://c3rb3r3u5d3d53c.github.io/2022/07/malware-reversing-workflow/"><meta property="og:image" content="https://c3rb3r3u5d3d53c.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-06T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-06T00:00:00+00:00"><meta property="og:site_name" content="Malware Hell"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://c3rb3r3u5d3d53c.github.io/logo.png"><meta name=twitter:title content="Malware Analysis and Reverse Engineering Workflow"><meta name=twitter:description content="A guide to my malware analysis and reverse engineering workflow."><meta name=application-name content="Malware Hell"><meta name=apple-mobile-web-app-title content="Malware Hell"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-reversing-workflow/><link rel=prev href=https://c3rb3r3u5d3d53c.github.io/2022/06/bitter-apt-zxxz-backdoor/><link rel=next href=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-sample-handling/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Malware Analysis and Reverse Engineering Workflow","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/c3rb3r3u5d3d53c.github.io\/2022\/07\/malware-reversing-workflow\/"},"genre":"posts","keywords":"Reversing, Malware, Workflow","wordcount":2302,"url":"https:\/\/c3rb3r3u5d3d53c.github.io\/2022\/07\/malware-reversing-workflow\/","datePublished":"2022-07-06T00:00:00+00:00","dateModified":"2022-07-06T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"c3rb3ru5d3d53c"},"description":"A guide to my malware analysis and reverse engineering workflow."}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Malware Hell"><span class=header-title-pre><i class='fa-solid fa-terminal' aria-hidden=true></i></span><span id=id-2 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Blog </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Malware Hell"><span class=header-title-pre><i class='fa-solid fa-terminal' aria-hidden=true></i></span><span id=id-3 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Blog</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Malware Analysis and Reverse Engineering Workflow</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://c3rb3r3u5d3d53c.github.io title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>c3rb3ru5d3d53c</a></span>&nbsp;<span class=post-category>included in <a href=/categories/docs/><i class="far fa-folder fa-fw" aria-hidden=true></i>Docs</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-07-06>2022-07-06</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;2302 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;11 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#prerequsites>Prerequsites</a></li><li><a href=#methodology>Methodology</a><ul><li><a href=#purpose-and-output>Purpose and Output</a></li><li><a href=#behavior>Behavior</a><ul><li><a href=#endpoint>Endpoint</a></li><li><a href=#network>Network</a></li></ul></li><li><a href=#detection>Detection</a></li></ul></li><li><a href=#process>Process</a><ul><li><a href=#overview>Overview</a></li><li><a href=#malware-analysis>Malware Analysis</a><ul><li><a href=#identify-filetype>Identify Filetype</a></li><li><a href=#analysis>Analysis</a><ul><li><a href=#static>Static</a></li><li><a href=#dynamic>Dynamic</a></li></ul></li><li><a href=#malicious-intent>Malicious Intent</a></li></ul></li><li><a href=#reverse-engineering>Reverse Engineering</a><ul><li><a href=#triage-review>Triage Review</a></li><li><a href=#reversing>Reversing</a></li></ul></li></ul></li><li><a href=#tips-and-tricks>Tips and Tricks</a><ul><li><a href=#standardized-analysis-folder-structure>Standardized Analysis Folder Structure</a></li><li><a href=#standardized-decompiler-code-style>Standardized Decompiler Code Style</a></li><li><a href=#comments>Comments</a></li><li><a href=#taking-notes>Taking Notes</a></li></ul></li><li><a href=#sharing-your-work-tlp>Sharing your Work (TLP)</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div><div class=content id=content><p>I have noticed that there is a lot of material on individual parts of the malware analysis and reverse engineering process. However, they do not cover really what someone&rsquo;s workflow is from start to finish. This guide will be an overview of my general workflow.</p><h2 id=prerequsites>Prerequsites</h2><ul><li>Ensure you have finished setting up your <a href=/documents/kvm-malware-lab/ rel>malware lab</a></li><li>This guide is not how everyone does it, everyone will refine their own workflow, which works best for them overtime.</li></ul><h2 id=methodology>Methodology</h2><p>When working on malware it is good to have a methodology to guide your operations. Without an overall methodology, your work will fall flat as you have no purpose. It is a cool emerging field and can make your company look awesome, but at the same time, reverse engineering is time consuming and very expensive. If extra care is not given to an overall direction you can become very ineffective. People who do not know about the technical challenges malware analysis and reverse engineering pose, believe that you can send them a report on a fully reversed malware sample in a couple of hours. It is up to us to educate them that this is not the case, as always things are usually much more complex than they seem. Based on the complexity of a malware sample it could take minutes, hours, days, months, years, it really just depends!</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/b35183e9fa94fff28e4e129af4fa073a85d50a59499b0688e9c3f21db9cdd7c0.png data-srcset="/images/b35183e9fa94fff28e4e129af4fa073a85d50a59499b0688e9c3f21db9cdd7c0.png, /images/b35183e9fa94fff28e4e129af4fa073a85d50a59499b0688e9c3f21db9cdd7c0.png 1.5x, /images/b35183e9fa94fff28e4e129af4fa073a85d50a59499b0688e9c3f21db9cdd7c0.png 2x" data-sizes=auto alt=/images/b35183e9fa94fff28e4e129af4fa073a85d50a59499b0688e9c3f21db9cdd7c0.png title=purpose width=998 height=493></p><p>Depending on where you work there will often be different methodologies to how they strategize this process. Because of this, do not be suprised when the methodology depicted in this guide is different elsewhere.</p><h3 id=purpose-and-output>Purpose and Output</h3><p>There are many purposes you can have when performing analysis like this.</p><ul><li>Detection Signatures</li><li>Malware Configuration Extractors (Intelligence)</li><li>Automated Unpacking</li><li>Tracking Threat Actors</li><li>Writing Technical Reports</li></ul><p>There are certainly other potential usecases for this kind of work.</p><p>However, these would be the usecases for most.</p><h3 id=behavior>Behavior</h3><p>When analyzing malware it is important to focus on its behavior. This tells us exactly what operations we can expect the malware to perform once its in a target environment.</p><h4 id=endpoint>Endpoint</h4><p>Endpoint behavior includes but is not limited to the following properties.</p><ul><li>Process Creation</li><li>File Create and Delete</li><li>Registry Keys</li><li>DNS</li><li>TCP Communication</li><li>Code Injection</li></ul><h4 id=network>Network</h4><p>Although there are some points regarding networking in the Endpoint section, this section is about full packet inspection. This is how the malware communicates, not just to a domain or IP address but the contents of that communication and how it behaves.</p><h3 id=detection>Detection</h3><p>One of the things I pride myself on is writing meaningful detection. Imagine going to the doctor because you are feeling sick. If the doctor checks you over and only confirms you are sick or gives you a vague diagnosis without more details, it creates a poor customer experience. In the cybersecurity industry we can attribute this experience to looking at VirusTotal antivirus detection names. When I write detection, i create heuristic as well as classification signatures. This ensures we can catch more malware at a larger scale but also catch the ones we already know about and provide that diagnosis people are looking for.</p><p>When executing this detection methodology, I focus on the Tools and Techniques Tactics and Procedures (TTPs). A great reference diagram for this is the pyramid of pain shown below.</p><figure><a class=lightgallery href=/images/57051927050c516e9cecce389a87e5077beb442324a59a67a442697ed4250a55.png title=/images/57051927050c516e9cecce389a87e5077beb442324a59a67a442697ed4250a55.png data-thumbnail=/images/57051927050c516e9cecce389a87e5077beb442324a59a67a442697ed4250a55.png data-sub-html="<h2>Pyramid of Pain</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=/images/57051927050c516e9cecce389a87e5077beb442324a59a67a442697ed4250a55.png data-srcset="/images/57051927050c516e9cecce389a87e5077beb442324a59a67a442697ed4250a55.png, /images/57051927050c516e9cecce389a87e5077beb442324a59a67a442697ed4250a55.png 1.5x, /images/57051927050c516e9cecce389a87e5077beb442324a59a67a442697ed4250a55.png 2x" data-sizes=auto alt=/images/57051927050c516e9cecce389a87e5077beb442324a59a67a442697ed4250a55.png width=2550 height=1613></a><figcaption class=image-caption>Pyramid of Pain</figcaption></figure><p>There is importance for intelligence like IP addresses hash values, domain names and network/host artifacts. However, this does not lie so much in detection, it lies more in verification of behaviors as observed by tier 1 SOC analysts, as well as, tracking threat actor infrastructure.</p><h2 id=process>Process</h2><p>When we work on malware analysis and reverse engineering it is important to have a process to keep you organized in your work. Without an overall process, it will be easy to become lost or have to redo work you have already completed.</p><p>It is also important that we are cognizant about the time complexity of our process. If we obtain our goal reasonably within the first stages of this pyramid, you must justify the expense of going further up the pyramid.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/28b128865d7b2af93c05445ac5c1b8756ff2b466424486034aeb3f45976ff6e3.png data-srcset="/images/28b128865d7b2af93c05445ac5c1b8756ff2b466424486034aeb3f45976ff6e3.png, /images/28b128865d7b2af93c05445ac5c1b8756ff2b466424486034aeb3f45976ff6e3.png 1.5x, /images/28b128865d7b2af93c05445ac5c1b8756ff2b466424486034aeb3f45976ff6e3.png 2x" data-sizes=auto alt=/images/28b128865d7b2af93c05445ac5c1b8756ff2b466424486034aeb3f45976ff6e3.png title=time-complexity width=500 height=355></p><p>Time is money and reverse engineering code takes a long time but can come with additional benifits. Again, without a clear methodology and direction you could waste a lot of time and money.</p><h3 id=overview>Overview</h3><p>The following graph provides an overview of the general process I follow.<div class=mermaid id=id-1></div></p><p>The graph above can be descrived as follows.</p><ul><li>Triage<ul><li>Identify Filetype<ul><li>Determine which tools to use for further analysis</li></ul></li><li>Malware Analysis<ul><li>Static Analysis<ul><li>Use static tools based on filetype</li></ul></li><li>Dynamic Analysis<ul><li>Execute the malware and observe its behavior</li></ul></li></ul></li><li>Malicious Intent<ul><li>Determine if the sample has malicious intent</li></ul></li></ul></li><li>Reversing<ul><li>Triage<ul><li>Determine the scope of work</li></ul></li><li>Actual Reversing</li><li>Scoped Result</li></ul></li></ul><h3 id=malware-analysis>Malware Analysis</h3><p>Malware analysis is a process to triage the beginning stages is to ensure that we have a high level overview of the sample that we will use later for reverse engineering. This saves us time in the process as it provides reliable situational awareness.</p><h4 id=identify-filetype>Identify Filetype</h4><p>We need to determine what kind of file we are working with as it will aid us in determing the tooling we will be using moving forward.</p><p>Suggested tools.</p><ul><li><a href=https://github.com/horsicq/Detect-It-Easy target=_blank rel="noopener noreffer">Detect it Easy</a></li><li>Linux <em>file</em> command</li><li>Binwalk</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install -y binwalk
</span></span></code></pre></td></tr></table></div></div><h4 id=analysis>Analysis</h4><p>The malware analysis stage for me depicts the part of the process where we start investigating for malicious intent. This process includes analysis of the sample using both static and dynamic analysis. However, it is a more surface level approach than reverse engineering.</p><h5 id=static>Static</h5><p>Before we can perform static analysis we must be able to understand what it means.</p><blockquote><p>Static program analysis is the analysis of computer software performed without executing any programs, in contrast with dynamic analysis, which is performed on programs during their execution. - <a href=https://en.wikipedia.org/wiki/Static_program_analysis target=_blank rel="noopener noreffer">https://en.wikipedia.org/wiki/Static_program_analysis</a></p></blockquote><p>This means we perform analysis without executing the sample.</p><p>Suggested tools.</p><ul><li><a href=https://www.winitor.com/download target=_blank rel="noopener noreffer">PEStudio</a></li><li><a href=https://github.com/hasherezade/pe-bear-releases target=_blank rel="noopener noreffer">PEBear</a></li><li><a href=https://github.com/horsicq/Detect-It-Easy target=_blank rel="noopener noreffer">Detect it Easy</a></li><li><a href=https://www.7-zip.org/ target=_blank rel="noopener noreffer">7zip</a></li><li><a href=https://github.com/VirusTotal/yara target=_blank rel="noopener noreffer">YARA</a></li><li><a href=https://www.virustotal.com/gui/home/upload target=_blank rel="noopener noreffer">VirusTotal</a></li><li><a href=https://bazaar.abuse.ch/ target=_blank rel="noopener noreffer">MalwareBazaar</a></li></ul><p>What we are looking for are indicators that clearly show malicious intent.</p><h5 id=dynamic>Dynamic</h5><p>Before we can perform dynamic analysis we must be able to understand its meaning first.</p><blockquote><p>Dynamic program analysis is the analysis of computer software that is performed by executing programs on a real or virtual processor. For dynamic program analysis to be effective, the target program must be executed with sufficient test inputs to cover almost all possible outputs. <a href=https://en.wikipedia.org/wiki/Dynamic_program_analysis target=_blank rel="noopener noreffer">https://en.wikipedia.org/wiki/Dynamic_program_analysis</a></p></blockquote><p>Now there are two types of dynamic analysis I like to do, the first one is automated dynamic analysis.</p><p>For automated dynamic analysis I will submit the sample I have to a sandbox service or my own sandbox system. Let us first understand what sanboxing is at a high level with the following definition.</p><blockquote><p>Sandboxing is <strong>used to test code or applications that could be malicious before serving it up to critical devices</strong>. In cybersecurity, sandboxing is used as a method to test software which would end up being categorized as “safe” or “unsafe” after the test. - <a href="https://blog.malwarebytes.com/awareness/2020/09/sandbox-in-security/#:~:text=Malware%20detection%20and%20sandboxing&text=Sandboxing%20is%20used%20to%20test,%E2%80%9Cunsafe%E2%80%9D%20after%20the%20test" target=_blank rel="noopener noreffer">Malware Bytes</a></p></blockquote><p>Now that we understand what sandboxing means I recommend the following resources.</p><ul><li><a href=https://app.any.run/submissions/ target=_blank rel="noopener noreffer">AnyRun</a></li><li><a href=https://www.hybrid-analysis.com/ target=_blank rel="noopener noreffer">HybridAnalysis</a></li><li><a href=https://capesandbox.com/analysis/ target=_blank rel="noopener noreffer">Cape Sandbox</a></li><li><a href=https://tria.ge/ target=_blank rel="noopener noreffer">Triage</a></li><li><a href=https://www.joesandbox.com/#windows target=_blank rel="noopener noreffer">Joe Sandbox</a></li></ul><p>Once you execute the sample in a sandbox, you will want to hunt for malicious intent.</p><p>The other type of dynamic analysis is to perform it manually on your own lab machine. To monitor the activity you can use tools like Wireshark for network and Procmon for endpoint behaviors. This type of dynamic analysis can involve manipulating the malware by responding to it over the network or placing files or other artifacts in places it needs them to enable further execution.</p><h4 id=malicious-intent>Malicious Intent</h4><p>After we finish our static and dynamic malware analysis we need to indicate if the sample has malicious intent or not. If we do determine it has malicious intent, we have some decisions on tasks we need to make.</p><ul><li>Refer to the <em>Purposes and Output</em> section and complete what is needed</li><li>Escalate to Reverse Engineering if needed</li></ul><p>Additional refrences for malicious intent.</p><ul><li><a href=https://attack.mitre.org/ target=_blank rel="noopener noreffer">Mire</a></li><li><a href=https://lolbas-project.github.io/ target=_blank rel="noopener noreffer">LOLBAS</a></li></ul><p>Depending on your scope of work and standard operating procedures and overall strategy, these will be the tasks you will need to decide you will complete or not.</p><p><em>NOTE: It is not always nessassary to escalate to reverse engineering, it depends again on the scope of work you receive and the complexity of the malware and the results you need. So the process can totally stop here and that&rsquo;s okay too!</em></p><h3 id=reverse-engineering>Reverse Engineering</h3><p>Reverse engineering can be defined as follows.</p><blockquote><p>Reverse engineering is a process or method through which one attempts to understand through deductive reasoning how a previously made device, process, system, or piece of software accomplishes a task with very little insight into exactly how it does so. - <a href=https://en.wikipedia.org/wiki/Reverse_engineering target=_blank rel="noopener noreffer">https://en.wikipedia.org/wiki/Reverse_engineering</a></p></blockquote><h4 id=triage-review>Triage Review</h4><p>This kind of triage is very different to triage for malware analysis. The goal of triage with reverse engineering is to use the information to help you identify areas of key interest in the malicious binary. For example, if the malware analysis triage notes indicate that the malware uses <em>ws2_32.dll</em> for communication, we can look into cross references for these API calls in the binary.</p><p>Once we have mapped out what tasks we wish to perform, we can move to the next step.</p><h4 id=reversing>Reversing</h4><p>In this stage we start actually reverse engineering the malware, typically we will use tools like Ghidra, IDA Pro and DNSpy to decompile the binary.</p><p>We will use these decompilers to create pseudo code.</p><blockquote><p>In computer science, pseudocode is a plain language description of the steps in an algorithm or another system. Pseudocode often uses structural conventions of a normal programming language, but is intended for human reading rather than machine reading.</p></blockquote><p>This code is an approximation of what the original code may look like.</p><p>It is up to us to clean this pseudo code up so we can make it more understandable for us humans to read.</p><p>This is a whole process of its own and we will not cover these specific principals in this workflow guide. We will save this for the reverse engineering guide.</p><p>Once completed, refer to the <em>Purposes and Output</em> section and complete what is needed.</p><h2 id=tips-and-tricks>Tips and Tricks</h2><p>Here are some basic tips and tricks to help you stay organized in this process.</p><h3 id=standardized-analysis-folder-structure>Standardized Analysis Folder Structure</h3><p>When I start a new task like this I create a folder that contains the following structure.</p><ul><li>docs - a folder containing documentation from public articles to and own notes</li><li>pcaps - packet capture files</li><li>samples - samples from the analysis, which may include multiple stages</li><li>scripts - scripts that help me automate the process</li><li>projects - contains project files for Ghidra, IDA and more</li></ul><p>With this folder structure I&rsquo;m able to know where I am and where I&rsquo;m going.</p><h3 id=standardized-decompiler-code-style>Standardized Decompiler Code Style</h3><p>When working in Ghidra or IDA Pro it&rsquo;s important for me to standardize how I name functions and variables in the pseudo code. Personally I keep this consistent with the standards as deemed by the operating system&rsquo;s programming guides. This ensures that the documentation and the style guidelines is easily accessable and understood by everyone.</p><h3 id=comments>Comments</h3><p>When working in Ghidra, IDA Pro or any other tool that allows you to make comments. Write lots of comments. This will keep you organized so that you know exactly where you are. If there are note taking features in the software you are using, take advantage of it.</p><h3 id=taking-notes>Taking Notes</h3><p>As I work through these processes, I will keep notes, typically in markdown format to keep myself organized. There are many different tools you can use to do this. However, I use Obsidian at the moment due to it&rsquo;s wide variety of features.</p><h2 id=sharing-your-work-tlp>Sharing your Work (TLP)</h2><p>When working with malware it is always a good idea to understand what the sharing rights of the samples you are working on.</p><table><thead><tr><th>TLP</th><th>Usage</th><th>Sharing</th></tr></thead><tbody><tr><td>TLP:RED</td><td>Sources may use TLP:RED when information cannot be effectively acted upon by additional parties, and could lead to impacts on a party&rsquo;s privacy, reputation, or operations if misused.</td><td>Recipients may not share TLP:RED information with any parties outside of the specific exchange, meeting, or conversation in which it was originally disclosed. In the context of a meeting, for example, TLP:RED information is limited to those present at the meeting. In most circumstances, TLP:RED should be exchanged verbally or in person.</td></tr><tr><td>TLP:AMBER</td><td>Sources may use TLP:AMBER when information requires support to be effectively acted upon, yet carries risks to privacy, reputation, or operations if shared outside of the organizations involved.</td><td>Recipients may only share TLP:AMBER information with members of their own organization, and with clients or customers who need to know the information to protect themselves or prevent further harm. Sources are at liberty to specify additional intended limits of the sharing: these must be adhered to.</td></tr><tr><td>TLP:GREEN</td><td>Sources may use TLP:GREEN when information is useful for the awareness of all participating organizations as well as with peers within the broader community or sector.</td><td>Recipients may share TLP:GREEN information with peers and partner organizations within their sector or community, but not via publicly accessible channels. Information in this category can be circulated widely within a particular community. TLP:GREEN information may not be released outside of the community.</td></tr><tr><td>TLP:WHITE</td><td>Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release.</td><td>Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction.</td></tr></tbody></table><p>When we share our reports, signatures and more we will typically apply Traffic Light Protocol (TLP) to the content. This way other people in the community can understand how they are able to use and share the content.</p><h2 id=conclusion>Conclusion</h2><p>When starting out for the first time it can be a daunting task even to begin understanding what someone&rsquo;s workflow may look like beginning to end. This guide hopefully helps you create your own workflow that makes sense for you.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-07-06</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-reversing-workflow/ data-title="Malware Analysis and Reverse Engineering Workflow" data-via=c3rb3ru5d3d53c data-hashtags=Reversing,Malware,Workflow><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-reversing-workflow/ data-hashtag=Reversing><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-reversing-workflow/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-reversing-workflow/ data-title="Malware Analysis and Reverse Engineering Workflow"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-reversing-workflow/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-reversing-workflow/ data-title="Malware Analysis and Reverse Engineering Workflow"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-reversing-workflow/ data-title="Malware Analysis and Reverse Engineering Workflow"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/reversing/>Reversing</a>,&nbsp;<a href=/tags/malware/>Malware</a>,&nbsp;<a href=/tags/workflow/>Workflow</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2022/06/bitter-apt-zxxz-backdoor/ class=prev rel=prev title="Making Fun of Your APT Malware - Bitter APT Using ZxxZ Backdoor to Target Pakistan Public Accounts Committee"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Making Fun of Your APT Malware - Bitter APT Using ZxxZ Backdoor to Target Pakistan Public Accounts Committee</a>
<a href=/2022/07/malware-sample-handling/ class=next rel=next title="Handling Malware Samples">Handling Malware Samples<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://c3rb3r3u5d3d53c.github.io target=_blank>c3rb3r3u5d3d53c</a></span>&nbsp;|&nbsp;<span class=license><a rel="this is free and unencumbered software released into the public domain." href=https://unlicense.org target=_blank>The Unlicense</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/mermaid@9.1.3/dist/mermaid.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},data:{"id-1":`  graph TD
	subgraph Malware Analysis
		0(Identify Filetype) \u0026 1(Analysis) \u0026 2(Malicious Intent?) \u0026 3(end)
	end
	subgraph Reverse Engineering
		4(Triage Review) \u0026 5(Reversing) \u0026 6(Scoped Result) \u0026 7(end)
	end
	 0 --\u003e|Select Tooling| 1
	 1 --\u003e|static/dynamic|2
	 2--\u003e|yes|4
	 2--\u003e|no|3
	 4--\u003e|scope of work|5
	 5--\u003e|process|6
	 6--\u003e7`,"id-2":"Malware Hell","id-3":"Malware Hell"},lightgallery:!0,search:{algoliaAppID:"",algoliaIndex:"",algoliaSearchKey:"",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"},twemoji:!0,typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"id-2":["id-2"],"id-3":["id-3"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>