<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Handling Malware Samples - Malware Hell</title><meta name=Description content="A guide on handling malware samples."><meta property="og:title" content="Handling Malware Samples"><meta property="og:description" content="A guide on handling malware samples."><meta property="og:type" content="article"><meta property="og:url" content="https://c3rb3r3u5d3d53c.github.io/2022/07/malware-sample-handling/"><meta property="og:image" content="https://c3rb3r3u5d3d53c.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-07T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-07T00:00:00+00:00"><meta property="og:site_name" content="Malware Hell"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://c3rb3r3u5d3d53c.github.io/logo.png"><meta name=twitter:title content="Handling Malware Samples"><meta name=twitter:description content="A guide on handling malware samples."><meta name=application-name content="Malware Hell"><meta name=apple-mobile-web-app-title content="Malware Hell"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-sample-handling/><link rel=prev href=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-reversing-workflow/><link rel=next href=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-script-deobfuscation/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Handling Malware Samples","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/c3rb3r3u5d3d53c.github.io\/2022\/07\/malware-sample-handling\/"},"genre":"posts","keywords":"Malware, Analysis","wordcount":723,"url":"https:\/\/c3rb3r3u5d3d53c.github.io\/2022\/07\/malware-sample-handling\/","datePublished":"2022-07-07T00:00:00+00:00","dateModified":"2022-07-07T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"c3rb3ru5d3d53c"},"description":"A guide on handling malware samples."}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Malware Hell"><span class=header-title-pre><i class='fa-solid fa-terminal' aria-hidden=true></i></span><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Blog </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Malware Hell"><span class=header-title-pre><i class='fa-solid fa-terminal' aria-hidden=true></i></span><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Blog</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Handling Malware Samples</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://c3rb3r3u5d3d53c.github.io title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>c3rb3ru5d3d53c</a></span>&nbsp;<span class=post-category>included in <a href=/categories/docs/><i class="far fa-folder fa-fw" aria-hidden=true></i>Docs</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-07-07>2022-07-07</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;723 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;4 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#making-it-more-safe>Making it more &ldquo;Safe&rdquo;</a><ul><li><a href=#samples>Samples</a></li><li><a href=#urls>URLs</a></li><li><a href=#ip-addresses>IP Addresses</a></li></ul></li><li><a href=#handling-samples>Handling Samples</a><ul><li><a href=#downloading-samples>Downloading Samples</a></li><li><a href=#understanding-the-risk>Understanding the Risk</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div><div class=content id=content><p>When you are first starting out in malware analysis or reverse engineering, it can be a very nerve racking experience to deal with malware samples. You might always have that little voice in your head thinking&mldr;</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/9641ef65890354c6be1dc43420a50f90eebd82e4e4b79a543266707c56cc93ba.jpg data-srcset="/images/9641ef65890354c6be1dc43420a50f90eebd82e4e4b79a543266707c56cc93ba.jpg, /images/9641ef65890354c6be1dc43420a50f90eebd82e4e4b79a543266707c56cc93ba.jpg 1.5x, /images/9641ef65890354c6be1dc43420a50f90eebd82e4e4b79a543266707c56cc93ba.jpg 2x" data-sizes=auto alt=/images/9641ef65890354c6be1dc43420a50f90eebd82e4e4b79a543266707c56cc93ba.jpg title=voices width=1005 height=500></p><blockquote><p>What if I double click by accident?</p></blockquote><blockquote><p>What if I press ENTER when I was not supposed to?</p></blockquote><blockquote><p>What if the malware breaks out of the VM?</p></blockquote><blockquote><p>Malware is bad</p></blockquote><blockquote><p>You don&rsquo;t want to be infected, do you?</p></blockquote><p>If you have these little voices in your head, you are not alone. Almost everyone who has worked in the industry has this little voice bugging them every day.</p><p>This guide will cover the absolute basics on handling malware samples, as well as, how to silence that little voice in your head you hear every time you start a new analysis.</p><h2 id=making-it-more-safe>Making it more &ldquo;Safe&rdquo;</h2><p>The industry will generally use two terms to describe making samples or indicators safe. These terms are <em>neutered</em> and <em>defanged</em>.</p><p>The process of doing this is different for samples and indicators.</p><h3 id=samples>Samples</h3><p>To make samples safe, we will typically store them in a ZIP encrypted archive with the password <em>infected</em>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir samples
</span></span><span class=line><span class=cl>mv sample.bin samples/
</span></span><span class=line><span class=cl>zip -P infected -e -r samples.zip samples/
</span></span><span class=line><span class=cl>rm -rf samples/
</span></span></code></pre></td></tr></table></div></div><h3 id=urls>URLs</h3><p>For URLs we will typically show them as follows.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>hxxp://example[.]com/malware.php
</span></span></code></pre></td></tr></table></div></div><p>This will ensure that the URL cannot be easily clicked by an unsuspecting user.</p><p>You will notice that <em>http</em> is replaced with <em>hxxp</em> and <em>.</em> is replaced with <em>[.]</em>.</p><h3 id=ip-addresses>IP Addresses</h3><p>For IP addresses we will typically show them as follows.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>8.8.8[.]8
</span></span></code></pre></td></tr></table></div></div><p>Similar to the URLs we simply replace the <em>.</em> with <em>[.]</em>.</p><h2 id=handling-samples>Handling Samples</h2><p>Now that we have a general understanding on how samples and indicators are made &ldquo;safe&rdquo;. We can now discuss how to handle the samples as part of our analysis process.</p><h3 id=downloading-samples>Downloading Samples</h3><p>Typically, when we download samples they will be in a ZIP encrypted format, with the password <em>infected</em>. This version we can download on our host machine as there is nothing inherently malicious about it, it&rsquo;s encrypted. If you wish to reduce risk even further, you can use another VM to download the malware instead of using your host machine.</p><p>Once we have the encrypted version downloaded, we can move the sample to the VM we wish to perform the analysis on.</p><p>Now that the encrypted version of the malware is in the VM, we can extract it there by entering the password <em>infected</em>.</p><p>Now we are ready to perform our analysis as the malicious unencrypted sample has not touched our host machine.</p><h3 id=understanding-the-risk>Understanding the Risk</h3><p>Just like workers who accept risk as part of their jobs in other industries, there are hazards and risks we all accept as part of our jobs in malware analysis and reverse engineering.</p><p>It is up to us to understand that these are risks of this job and do our best to mitigate what is under our control.</p><p>Just like anyone on jobs that involve risk, we accept a certain amount of it when we signup to be a malware analyst or reverse engineer.</p><p>These risks include, but are not limited to.</p><ul><li>Infecting yourself</li><li>VM escaping malware</li><li>Becoming a High Value Target (HVT) for nation-state or criminal groups</li></ul><p>You can think of malware breaking out of VMs much like getting struck by lightening, it can happen but it is a very rare occurrence.</p><p>The possibility of becoming a High Value Target (HVT) for criminal or nation-state groups is why I do my best to separate my personal identity from my independent research. There are times I let people in, but it is usually based on a need. Some people may laugh at your hacker handle or alias but in my opinion it is necessary.</p><h2 id=conclusion>Conclusion</h2><p>We all accept a certain amount of risk in this industry, other industries also have risk they must accept. Accepting risk as part of a profession is not uncommon. However, the risk we take on in malware analysis and reverse engineering is quite different. If we want to work in this field we must learn to accept a reasonable amount of risk that comes with the job. Again, it is okay to be a little frightened as a reality check is often good for us. At the same time, understand that occurances are usually rare.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-07-07</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-sample-handling/ data-title="Handling Malware Samples" data-via=c3rb3ru5d3d53c data-hashtags=Malware,Analysis><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-sample-handling/ data-hashtag=Malware><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-sample-handling/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-sample-handling/ data-title="Handling Malware Samples"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-sample-handling/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-sample-handling/ data-title="Handling Malware Samples"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/malware-sample-handling/ data-title="Handling Malware Samples"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/malware/>Malware</a>,&nbsp;<a href=/tags/analysis/>Analysis</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2022/07/malware-reversing-workflow/ class=prev rel=prev title="Malware Analysis and Reverse Engineering Workflow"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Malware Analysis and Reverse Engineering Workflow</a>
<a href=/2022/07/malware-script-deobfuscation/ class=next rel=next title="Deobfuscating Scripts">Deobfuscating Scripts<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://c3rb3r3u5d3d53c.github.io target=_blank>c3rb3r3u5d3d53c</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},data:{"id-1":"Malware Hell","id-2":"Malware Hell"},lightgallery:!0,search:{algoliaAppID:"",algoliaIndex:"",algoliaSearchKey:"",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"},twemoji:!0,typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>