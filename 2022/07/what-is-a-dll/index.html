<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>What is a DLL? - Malware Hell</title><meta name=Description content="A guide to what a DLL is."><meta property="og:title" content="What is a DLL?"><meta property="og:description" content="A guide to what a DLL is."><meta property="og:type" content="article"><meta property="og:url" content="https://c3rb3r3u5d3d53c.github.io/2022/07/what-is-a-dll/"><meta property="og:image" content="https://c3rb3r3u5d3d53c.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-20T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-20T00:00:00+00:00"><meta property="og:site_name" content="Malware Hell"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://c3rb3r3u5d3d53c.github.io/logo.png"><meta name=twitter:title content="What is a DLL?"><meta name=twitter:description content="A guide to what a DLL is."><meta name=application-name content="Malware Hell"><meta name=apple-mobile-web-app-title content="Malware Hell"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://c3rb3r3u5d3d53c.github.io/2022/07/what-is-a-dll/><link rel=prev href=https://c3rb3r3u5d3d53c.github.io/2022/07/lockbit-api-hashing/><link rel=next href=https://c3rb3r3u5d3d53c.github.io/2022/08/malware-reversing-rust/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"What is a DLL?","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/c3rb3r3u5d3d53c.github.io\/2022\/07\/what-is-a-dll\/"},"genre":"posts","keywords":"DLL, PE, Executable, Library","wordcount":370,"url":"https:\/\/c3rb3r3u5d3d53c.github.io\/2022\/07\/what-is-a-dll\/","datePublished":"2022-07-20T00:00:00+00:00","dateModified":"2022-07-20T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"c3rb3ru5d3d53c"},"description":"A guide to what a DLL is."}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Malware Hell"><span class=header-title-pre><i class='fa-solid fa-terminal' aria-hidden=true></i></span><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/><i class="fa-solid fa-square-pen"></i> </a><a class=menu-item href=/tags/><i class="fa-solid fa-tag"></i> </a><a class=menu-item href=/categories/><i class="fa-solid fa-folder"></i> </a><a class=menu-item href=https://discord.gg/NzaXGDVYkD rel="noopener noreffer" target=_blank><i class="fa-brands fa-discord"></i> <i class="fa-solid fa-server"></i></a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Malware Hell"><span class=header-title-pre><i class='fa-solid fa-terminal' aria-hidden=true></i></span><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title><i class="fa-solid fa-square-pen"></i></a><a class=menu-item href=/tags/ title><i class="fa-solid fa-tag"></i></a><a class=menu-item href=/categories/ title><i class="fa-solid fa-folder"></i></a><a class=menu-item href=https://discord.gg/NzaXGDVYkD title rel="noopener noreffer" target=_blank><i class="fa-brands fa-discord"></i><i class="fa-solid fa-server"></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">What is a DLL?</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://c3rb3r3u5d3d53c.github.io title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>c3rb3ru5d3d53c</a></span>&nbsp;<span class=post-category>included in <a href=/categories/docs/><i class="far fa-folder fa-fw" aria-hidden=true></i>Docs</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-07-20>2022-07-20</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;370 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;2 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#dynamic-linking>Dynamic Linking</a></li><li><a href=#relative-virtual-addresses-rvas>Relative Virtual Addresses (RVAs)</a></li><li><a href=#execution>Execution</a></li><li><a href=#analysis-tips>Analysis Tips</a></li></ul></nav></div></div><div class=content id=content><h2 id=introduction>Introduction</h2><p>Hey everybody, it&rsquo;s cerberus and welcome to malware hell. Today we are going to do a whiteboard session on what a DLL is and why it is important to malware reverse engineering and analysis.</p><p>Dynamic-link library (DLL) is Microsoft&rsquo;s implementation of the shared library concept in the Microsoft Windows and OS/2 operating systems. These libraries usually have the file extension DLL, OCX (for libraries containing ActiveX controls), or DRV (for legacy system drivers).</p><ul><li>Describe PE File Format</li><li>Explain RVAs</li><li>Explain Dynamic Linking</li><li>Demonstrate DLL usage</li></ul><h2 id=dynamic-linking>Dynamic Linking</h2><blockquote><p>Dynamic linking means that the code for some external routines is located and loaded when the program is first run. When you compile a program that uses shared libraries, the shared libraries are dynamically linked to your program by default.</p></blockquote><p>Benefits:</p><ul><li>Save Storage Space</li><li>Decrease Code Reuse</li></ul><h2 id=relative-virtual-addresses-rvas>Relative Virtual Addresses (RVAs)</h2><p>Relative Virtual Address or RVA (here afterward) is the difference between two Virtual Addresses (VA) and represents the highest one. Virtual Address is the original address in the memory whereas Relative Virtual Address (RVA) is the relative address with respect to the ImageBase. ImageBase here means the base address where the executable file is first loaded into the memory.</p><p>We can calculate RVA with the help of the following formula:<br><strong>RVA = VA – ImageBase</strong></p><p>Have a look at the example below for more clarification:</p><p>An application is loaded into the memory having a Base Address at 0x400000 and the VA is at 0x401000. So the RVA is calculated as:</p><p><strong>Virtual Address</strong> = 0x00401000<br><strong>ImageBase</strong> = 0x00400000<br><strong>RVA</strong> = 0x00001000</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=err> </span><span class=k>typedef</span> <span class=k>struct</span> <span class=nc>_IMAGE_EXPORT_DIRECTORY</span> <span class=p>{</span>  
</span></span><span class=line><span class=cl>	<span class=k>public</span> <span class=n>UInt32</span> <span class=n>Characteristics</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>	<span class=k>public</span> <span class=n>UInt32</span> <span class=n>TimeDateStamp</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>	<span class=k>public</span> <span class=n>UInt16</span> <span class=n>MajorVersion</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>	<span class=k>public</span> <span class=n>UInt16</span> <span class=n>MinorVersion</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>	<span class=k>public</span> <span class=n>UInt32</span> <span class=n>Name</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>	<span class=k>public</span> <span class=n>UInt32</span> <span class=n>Base</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>	<span class=k>public</span> <span class=n>UInt32</span> <span class=n>NumberOfFunctions</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>	<span class=k>public</span> <span class=n>UInt32</span> <span class=n>NumberOfNames</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>	<span class=k>public</span> <span class=n>UInt32</span> <span class=n>AddressOfFunctions</span><span class=p>;</span><span class=err>    </span> <span class=c1>// RVA from base of image  (array of function addrs)
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>public</span> <span class=n>UInt32</span> <span class=n>AddressOfNames</span><span class=p>;</span><span class=err>    </span>     <span class=c1>// RVA from base of image  (array of names)
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>public</span> <span class=n>UInt32</span> <span class=n>AddressOfNameOrdinals</span><span class=p>;</span><span class=err>  </span><span class=c1>// RVA from base of image  (array of ordinals)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span> <span class=n>IMAGE_EXPORT_DIRECTORY</span><span class=p>,</span> <span class=o>*</span><span class=n>PIMAGE_EXPORT_DIRECTORY</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=execution>Execution</h2><ul><li>DLLMain</li><li>Exported Functions</li><li>regsvr32.exe</li><li>rundll32.exe</li><li>DLL Search Order (side loading)</li></ul><h2 id=analysis-tips>Analysis Tips</h2><ul><li>Execution Context (which exported function was executed, what program executed it)<ul><li>DllRegisterServer</li><li>DllUnregisterServer</li></ul></li><li>Consider the DLLMain function</li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-07-20</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/what-is-a-dll/ data-title="What is a DLL?" data-via=c3rb3ru5d3d53c data-hashtags=DLL,PE,Executable,Library><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/what-is-a-dll/ data-hashtag=DLL><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/what-is-a-dll/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/what-is-a-dll/ data-title="What is a DLL?"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/what-is-a-dll/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/what-is-a-dll/ data-title="What is a DLL?"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://c3rb3r3u5d3d53c.github.io/2022/07/what-is-a-dll/ data-title="What is a DLL?"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/dll/>DLL</a>,&nbsp;<a href=/tags/pe/>PE</a>,&nbsp;<a href=/tags/executable/>Executable</a>,&nbsp;<a href=/tags/library/>Library</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2022/07/lockbit-api-hashing/ class=prev rel=prev title="Reversing Additional Lockbit 3.0 API Hashing"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Reversing Additional Lockbit 3.0 API Hashing</a>
<a href=/2022/08/malware-reversing-rust/ class=next rel=next title="A Reverse Engineering Guide for Rust Binaries">A Reverse Engineering Guide for Rust Binaries<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://c3rb3r3u5d3d53c.github.io target=_blank>c3rb3r3u5d3d53c</a></span>&nbsp;|&nbsp;<span class=license><a rel="this is free and unencumbered software released into the public domain." href=https://unlicense.org target=_blank>The Unlicense</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},data:{"id-1":"Malware Hell","id-2":"Malware Hell"},lightgallery:!0,search:{algoliaAppID:"",algoliaIndex:"",algoliaSearchKey:"",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"},twemoji:!0,typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>