<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>A Reverse Engineering Guide for Rust Binaries - Malware Hell</title><meta name=Description content="A guide to reverse engineering Rust binaries."><meta property="og:title" content="A Reverse Engineering Guide for Rust Binaries"><meta property="og:description" content="A guide to reverse engineering Rust binaries."><meta property="og:type" content="article"><meta property="og:url" content="https://c3rb3r3u5d3d53c.github.io/2022/08/malware-reversing-rust/"><meta property="og:image" content="https://c3rb3r3u5d3d53c.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-04T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-04T00:00:00+00:00"><meta property="og:site_name" content="Malware Hell"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://c3rb3r3u5d3d53c.github.io/logo.png"><meta name=twitter:title content="A Reverse Engineering Guide for Rust Binaries"><meta name=twitter:description content="A guide to reverse engineering Rust binaries."><meta name=application-name content="Malware Hell"><meta name=apple-mobile-web-app-title content="Malware Hell"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://c3rb3r3u5d3d53c.github.io/2022/08/malware-reversing-rust/><link rel=prev href=https://c3rb3r3u5d3d53c.github.io/2022/07/what-is-a-dll/><link rel=next href=https://c3rb3r3u5d3d53c.github.io/2022/11/twitch-live-chat/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"A Reverse Engineering Guide for Rust Binaries","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/c3rb3r3u5d3d53c.github.io\/2022\/08\/malware-reversing-rust\/"},"genre":"posts","keywords":"Rust, Reversing, Guide","wordcount":1060,"url":"https:\/\/c3rb3r3u5d3d53c.github.io\/2022\/08\/malware-reversing-rust\/","datePublished":"2022-08-04T00:00:00+00:00","dateModified":"2022-08-04T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"c3rb3ru5d3d53c"},"description":"A guide to reverse engineering Rust binaries."}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Malware Hell"><span class=header-title-pre><i class='fa-solid fa-terminal' aria-hidden=true></i></span><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/ title=Blog><i class="fa-solid fa-square-pen"></i> </a><a class=menu-item href=/tags/ title=Tags><i class="fa-solid fa-tag"></i> </a><a class=menu-item href=/categories/ title=Categories><i class="fa-solid fa-folder"></i> </a><a class=menu-item href=https://discord.gg/NzaXGDVYkD title="Discord Server" rel="noopener noreffer" target=_blank><i class="fa-brands fa-discord"></i> <i class="fa-solid fa-server"></i></a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Malware Hell"><span class=header-title-pre><i class='fa-solid fa-terminal' aria-hidden=true></i></span><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title=Blog><i class="fa-solid fa-square-pen"></i></a><a class=menu-item href=/tags/ title=Tags><i class="fa-solid fa-tag"></i></a><a class=menu-item href=/categories/ title=Categories><i class="fa-solid fa-folder"></i></a><a class=menu-item href=https://discord.gg/NzaXGDVYkD title="Discord Server" rel="noopener noreffer" target=_blank><i class="fa-brands fa-discord"></i><i class="fa-solid fa-server"></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">A Reverse Engineering Guide for Rust Binaries</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://c3rb3r3u5d3d53c.github.io title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>c3rb3ru5d3d53c</a></span>&nbsp;<span class=post-category>included in <a href=/categories/docs/><i class="far fa-folder fa-fw" aria-hidden=true></i>Docs</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-08-04>2022-08-04</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1060 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;5 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#rusts-origin-story>Rust&rsquo;s Origin Story</a></li><li><a href=#memory>Memory</a></li><li><a href=#rust-toolset>Rust Toolset</a><ul><li><a href=#rustc>rustc</a></li><li><a href=#cargo>cargo</a></li></ul></li><li><a href=#reverse-engineering-challenges>Reverse Engineering Challenges</a><ul><li><a href=#strings-without-null-termination>Strings without NULL Termination</a></li><li><a href=#static-linking>Static Linking</a></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=introduction>Introduction</h2><p>The <a href=https://en.wikipedia.org/wiki/Rust_%28programming_language%29 target=_blank rel="noopener noreffer">Rust</a> programming language is like rust on a vehicle for malware analysts and reverse engineers. The adoption of the language by malware authors spreads like cancer the longer it is in active development. This is due to convenient static linking and support for many operating systems, yielding a binary with little to no dependencies. These features are excellent for the distribution of malware. Every time we need to reverse engineer a Rust binary, we would rather embrace the sweet release of death. We need to take a deeper look into why our current tools are failing to help us perform our jobs effectively. As always with new technologies, it will take some time for our tools to catch up with new compilers. To better understand <a href=https://en.wikipedia.org/wiki/Rust_%28programming_language%29 target=_blank rel="noopener noreffer">Rust</a>, let&rsquo;s have a look at its official definition.</p><blockquote><p>Rust is a multi-paradigm, general-purpose programming language. Rust emphasizes performance, type safety, and concurrency. Rust enforces memory safetyâ€”that is, that all references point to valid memoryâ€”without requiring the use of a garbage collector or reference counting present in other memory-safe languages. To simultaneously enforce memory safety and prevent concurrent data races, Rust&rsquo;s borrow checker tracks the object lifetime and variable scope of all references in a program during compilation. Rust is popular for systems programming, but also offers high-level features, including functional programming constructs. - <a href=https://en.wikipedia.org/wiki/Rust_%28programming_language%29 target=_blank rel="noopener noreffer">Wikipedia</a></p></blockquote><p>Now that you have a basic understanding of what Rust is, we will now break down some common misconceptions. After this, we will discuss the toolset and reverse engineering challenges.</p><h2 id=rusts-origin-story>Rust&rsquo;s Origin Story</h2><p><a href=https://en.wikipedia.org/wiki/Rust_%28programming_language%29 target=_blank rel="noopener noreffer">Rust</a>, like pretty much all modern programming languages these days, was created using LLVM. The very language Rust developers hate, <em>C</em> or <em>C++</em> is used to create <a href=https://en.wikipedia.org/wiki/Rust_%28programming_language%29 target=_blank rel="noopener noreffer">Rust</a>. Let that shit sink into your heads for a minute.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/dc4da815e74aef5281477e80702d9c46cdc366b74927073e3caac9f2b1d20b8c.jpg data-srcset="/images/dc4da815e74aef5281477e80702d9c46cdc366b74927073e3caac9f2b1d20b8c.jpg, /images/dc4da815e74aef5281477e80702d9c46cdc366b74927073e3caac9f2b1d20b8c.jpg 1.5x, /images/dc4da815e74aef5281477e80702d9c46cdc366b74927073e3caac9f2b1d20b8c.jpg 2x" data-sizes=auto alt=/images/dc4da815e74aef5281477e80702d9c46cdc366b74927073e3caac9f2b1d20b8c.jpg title=rust_creation_meme width=534 height=467></p><p>Compilers are not magic, they are usually created from lower level programming languages. Without an egg, how do you get chickens or your American breakfast in the morning, It must originate from somewhere.</p><p>If you need entertainment, tell a Rust fanboy or fangirl that Rust came from C++ and LLVM. Then watch them question everything they thought they knew. ðŸ˜†</p><h2 id=memory>Memory</h2><p>Don&rsquo;t be fooled, although it has been stated that <a href=https://en.wikipedia.org/wiki/Rust_%28programming_language%29 target=_blank rel="noopener noreffer">Rust</a> does not have a garbage collector, this is based on a definition technicality. Yes, we are talking about semantics at this point, in my opinion. ðŸ˜…</p><p>Rust does more memory garbage collection calculation during compile time, instead of during runtime.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/0650c178bacfbf4a0139be796e1a72b3014f112ce03d3037e9f62ef5e7e680fa.jpg data-srcset="/images/0650c178bacfbf4a0139be796e1a72b3014f112ce03d3037e9f62ef5e7e680fa.jpg, /images/0650c178bacfbf4a0139be796e1a72b3014f112ce03d3037e9f62ef5e7e680fa.jpg 1.5x, /images/0650c178bacfbf4a0139be796e1a72b3014f112ce03d3037e9f62ef5e7e680fa.jpg 2x" data-sizes=auto alt=/images/0650c178bacfbf4a0139be796e1a72b3014f112ce03d3037e9f62ef5e7e680fa.jpg title=rustc_meme width=500 height=709></p><p>Although Rust fanatics think the language is a safe haven with no vulnerabilities, you can still perform unsafe memory operations in Rust as well by using the <a href=https://doc.rust-lang.org/book/ch19-01-unsafe-rust.html target=_blank rel="noopener noreffer"><em>unsafe</em></a> keyword. In the <em>unsafe</em> block you can dereference raw pointers, implement unsafe traits, access or modify a mutable static variable, call unsafe functions or methods.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>extern</span><span class=w> </span><span class=k>crate</span><span class=w> </span><span class=n>libc</span><span class=p>;</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>mem</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>unsafe</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>my_num</span>: <span class=o>*</span><span class=k>mut</span><span class=w> </span><span class=kt>i32</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>libc</span>::<span class=n>malloc</span><span class=p>(</span><span class=n>mem</span>::<span class=n>size_of</span>::<span class=o>&lt;</span><span class=kt>i32</span><span class=o>&gt;</span><span class=p>()</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>libc</span>::<span class=n>size_t</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=o>*</span><span class=k>mut</span><span class=w> </span><span class=kt>i32</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>libc</span>::<span class=n>free</span><span class=p>(</span><span class=n>my_num</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=o>*</span><span class=k>mut</span><span class=w> </span><span class=n>libc</span>::<span class=n>c_void</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>It is important to note that although <em>unsafe</em> is used, the <em>rustc</em> compiler will still insert some memory safety features.</p><p>This makes <em>rustc</em> a very powerful compiler where the developer can completely bypass safety to do lower level operations just like in <em>C</em>, <em>Assembly</em> or <em>C++</em>.</p><p>Rust provides &ldquo;<em>memory safe</em>&rdquo; options much like in <em>C++</em>, when you use <em>std::string</em> the compiler will deallocate the object once it is no longer referenced. As with any technology, the language is not completely &ldquo;memory safe&rdquo; as they may advertise. With any application there can be vulnerabilities, humans did write the Rust programming language, developers can still insert <em>unsafe</em> code, and we are not infallible creatures.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/cef29a8a960c48bdad67ed2b3e80d7655684836520cfa3958abf894bac969180.jpg data-srcset="/images/cef29a8a960c48bdad67ed2b3e80d7655684836520cfa3958abf894bac969180.jpg, /images/cef29a8a960c48bdad67ed2b3e80d7655684836520cfa3958abf894bac969180.jpg 1.5x, /images/cef29a8a960c48bdad67ed2b3e80d7655684836520cfa3958abf894bac969180.jpg 2x" data-sizes=auto alt=/images/cef29a8a960c48bdad67ed2b3e80d7655684836520cfa3958abf894bac969180.jpg title=bicycle_meme width=500 height=680></p><p>We now learned that Rust developers can introduce <em>unsafe</em> memory operations into their applications. Also, we now know that garbage collection still happens but more so, it&rsquo;s added to the program during compile time rather than handled during runtime. Again, if you have a &ldquo;<em>memory safe</em>&rdquo; language, the cleanup of memory must be handled for you somehow, that garbage has to go somewhere, it just does not disappear into the void magically.</p><h2 id=rust-toolset>Rust Toolset</h2><p>In order to understand how to reverse engineer Rust binaries, we should have a basic understanding of the toolset provided to developers.</p><h3 id=rustc>rustc</h3><p>The compiler <em>rustc</em> is used to compile Rust code.</p><p>Most developers do not invoke <em>rustc</em> directly, but instead use <em>cargo</em>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cargo build --verbose
</span></span></code></pre></td></tr></table></div></div><h3 id=cargo>cargo</h3><p>Cargo is a Rust package manager, it will download package dependencies, compiles packages, distributes packages by uploading them to <em>crates.io</em>.</p><p>Think of it like <em>pip</em> for Python.</p><h2 id=reverse-engineering-challenges>Reverse Engineering Challenges</h2><p>This section will cover challenges we face with our existing tooling when reverse engineering <a href=https://en.wikipedia.org/wiki/Rust_%28programming_language%29 target=_blank rel="noopener noreffer">Rust</a> binaries.</p><h3 id=strings-without-null-termination>Strings without NULL Termination</h3><p>Rust will store strings differently than most compilers, it will store them without NULL termination between strings, then reference the very long strings with a table.</p><p>Rust will store strings differently than most compilers, it will store them as multiple strings all together without NULL terminators between them. The address of these very long strings will be referenced by pointer and size in a table.</p><p>We can emulate how Rust prints strings by using the format strings with <code>%.*s</code> and how it avoids using NULL terminators in the following code.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define STRING_SIZE   27
</span></span></span><span class=line><span class=cl><span class=cp>#define STRING_SIZE_0 13
</span></span></span><span class=line><span class=cl><span class=cp>#define STRING_SIZE_1 13
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=k>typedef</span> <span class=k>struct</span> <span class=nc>_RUST_STRINGS</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=o>*</span><span class=n>ascii</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>size</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=n>RUST_STRINGS</span><span class=p>,</span> <span class=o>*</span><span class=n>PRUST_STRINGS</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>){</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>g_strings</span><span class=p>[</span><span class=n>STRING_SIZE</span><span class=p>]</span> <span class=o>=</span> <span class=s>&#34;Hello World!</span><span class=se>\n</span><span class=s>Hello There!</span><span class=se>\n\0</span><span class=s>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>RUST_STRINGS</span> <span class=n>rstrings</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	  <span class=p>{(</span><span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=o>*&amp;</span><span class=n>g_strings</span><span class=p>,</span> <span class=n>STRING_SIZE_0</span><span class=p>},</span>
</span></span><span class=line><span class=cl>	  <span class=p>{(</span><span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>g_strings</span><span class=o>+</span><span class=n>STRING_SIZE_0</span><span class=p>,</span> <span class=n>STRING_SIZE_1</span><span class=p>}};</span>
</span></span><span class=line><span class=cl>  <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%.*s&#34;</span><span class=p>,</span> <span class=n>rstrings</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>,</span> <span class=n>rstrings</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>ascii</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%.*s&#34;</span><span class=p>,</span> <span class=n>rstrings</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>size</span><span class=p>,</span> <span class=n>rstrings</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>ascii</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>While this may seem like a complete waste of time, there are a few benefits to storing strings without the NULL terminators this way.</p><ul><li>Fewer calls to <code>strlen()</code> or other equivalent system calls</li><li>String manipulation, concatenation, truncation etc.</li></ul><p>The functional equivalent code in Rust would be as follows.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>let</span><span class=w> </span><span class=n>string_0</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;Hello World!&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>let</span><span class=w> </span><span class=n>string_1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;Hello There!&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;</span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>string_0</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;</span><span class=si>{}</span><span class=s>&#34;</span><span class=p>,</span><span class=w> </span><span class=n>string_1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><em>NOTE: This Rust code is not 100% the equivalent, just covering the basic principles</em></p><p>We can combat string issues in Rust binaries by defining the proper table structures in your decompiler.</p><p>This type of string operations will potentially increase performance at the expense of your sanity.</p><h3 id=static-linking>Static Linking</h3><p>Placeholder</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-08-04</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://c3rb3r3u5d3d53c.github.io/2022/08/malware-reversing-rust/ data-title="A Reverse Engineering Guide for Rust Binaries" data-via=c3rb3ru5d3d53c data-hashtags=Rust,Reversing,Guide><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://c3rb3r3u5d3d53c.github.io/2022/08/malware-reversing-rust/ data-hashtag=Rust><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://c3rb3r3u5d3d53c.github.io/2022/08/malware-reversing-rust/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://c3rb3r3u5d3d53c.github.io/2022/08/malware-reversing-rust/ data-title="A Reverse Engineering Guide for Rust Binaries"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://c3rb3r3u5d3d53c.github.io/2022/08/malware-reversing-rust/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://c3rb3r3u5d3d53c.github.io/2022/08/malware-reversing-rust/ data-title="A Reverse Engineering Guide for Rust Binaries"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on å¾®åš" data-sharer=weibo data-url=https://c3rb3r3u5d3d53c.github.io/2022/08/malware-reversing-rust/ data-title="A Reverse Engineering Guide for Rust Binaries"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/rust/>Rust</a>,&nbsp;<a href=/tags/reversing/>Reversing</a>,&nbsp;<a href=/tags/guide/>Guide</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2022/07/what-is-a-dll/ class=prev rel=prev title="What is a DLL?"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>What is a DLL?</a>
<a href=/2022/11/twitch-live-chat/ class=next rel=next title="Twitch Streaming Live Chat for OBS">Twitch Streaming Live Chat for OBS<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://c3rb3r3u5d3d53c.github.io target=_blank>c3rb3r3u5d3d53c</a></span>&nbsp;|&nbsp;<span class=license><a rel="this is free and unencumbered software released into the public domain." href=https://unlicense.org target=_blank>The Unlicense</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},data:{"id-1":"Malware Hell","id-2":"Malware Hell"},lightgallery:!0,search:{algoliaAppID:"",algoliaIndex:"",algoliaSearchKey:"",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"},twemoji:!0,typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"id-1":["id-1"],"id-2":["id-2"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>