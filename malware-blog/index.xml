<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Malware Blog on Malware Hell</title><link>https://c3rb3ru5d3d53c.github.io/malware-blog/</link><description>Recent content in Malware Blog on Malware Hell</description><generator>Hugo -- gohugo.io</generator><language>en</language><copyright>&amp;copy; 2022 &lt;a href="https://twitter.com/c3rb3ru5d3d53c">c3rb3ru5d3d53c&lt;/a></copyright><lastBuildDate>Tue, 29 Nov 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://c3rb3ru5d3d53c.github.io/malware-blog/index.xml" rel="self" type="application/rss+xml"/><item><title>Reversing Redline Stealer</title><link>https://c3rb3ru5d3d53c.github.io/malware-blog/redline-stealer/</link><pubDate>Tue, 29 Nov 2022 00:00:00 +0000</pubDate><guid>https://c3rb3ru5d3d53c.github.io/malware-blog/redline-stealer/</guid><description>PLACEHOLDER SITUATIONAL AWARENESS
Infection Chain Installer ‚Üí Quella.mp3 (BAT) ‚Üí Mantenga.exe.pif (Loader) ‚Üí jsc.exe
The installer executes cmd /c cmd &amp;lt; Quella.mp3 &amp;amp; ping -n 5 localhost, which later creates Mantenga.exe.pif, which is an AutoIT interpreter.
Looks like they are doing process hollowing from the autoit script.
CreateProcessW NtWriteVirtualMemory NtReadVirtualMemory NtWriteVirtualMemory NtProtectVirtualMemory NtSetContextThread NtResumeThread NtUnmapViewOfSection Redline Stealer PLACHOLDER
Indicators of Compromise Type Indicator Description SHA256 532c47de5bdd433bea776290d27a741b09a1d5c5f2089e54eced922514a60799 Redline Stealer Installer File SHA256 3e8d604a5d545189c35d810845b3e2208e3c56081507b949ecb17a6bbd4decb1 Messed Up PE File (Che.</description></item><item><title>DarkCloud Stealer Triage</title><link>https://c3rb3ru5d3d53c.github.io/malware-blog/darkcloud-stealer/</link><pubDate>Sat, 01 Oct 2022 00:00:00 +0000</pubDate><guid>https://c3rb3ru5d3d53c.github.io/malware-blog/darkcloud-stealer/</guid><description>Placeholder
Protected with .NET Reactor I obtained a sample of DarkCloud Stealer from @James_inthe_box, which is a 7zip compressed (fc55a2bd0a266b8eca264b9b74afff9d373746910035d18c901ac718b6c3948f). Once extracted, it results in the file FILENAME (3dbcb27a7f441b6f3d6e47d9ae69c69a1af582b3e5c0dce44642e5d0ad0cf566), which is packed with .NET reactor.
Persistence Next, it establishes persistence with the command.
&amp;quot;C:\Windows\System32\schtasks.exe&amp;quot; /Create /TN &amp;quot;Updates\jDDrSpcG&amp;quot; /XML &amp;quot;C:\Users\admin\AppData\Local\Temp\tmp3332.tmp&amp;quot; PE Injection Once persistence is established, it will create the new process RegSvcs.exe, to perform PE injection. Next, it writes DarkCloud to this new process and resuming the thread.</description></item><item><title>Reversing Additional Lockbit 3.0 API Hashing</title><link>https://c3rb3ru5d3d53c.github.io/malware-blog/lockbit-v3-api-hashing/</link><pubDate>Wed, 13 Jul 2022 00:00:00 +0000</pubDate><guid>https://c3rb3ru5d3d53c.github.io/malware-blog/lockbit-v3-api-hashing/</guid><description>I was watching @herrcore&amp;rsquo;s OALabs stream on Lockbit 3.0. After he wrote a utility to decrypt additional data from the ransomware, he noticed one of the buffers was a Portable Executable (PE) file. It had an interesting API hashing routine, we would be reversing for the next stream.
I decided to have a closer look. üòÑ
Analysis This is an interesting sample, I have not mapped out its full functionality yet.
However, I was able to get a decent amount of reversing done, which should give us more of an insight.</description></item><item><title>Making Fun of Your APT Malware - Bitter APT Using ZxxZ Backdoor to Target Pakistan Public Accounts Committee</title><link>https://c3rb3ru5d3d53c.github.io/malware-blog/2022-07-04-bitter-apt-zxxz-backdoor/</link><pubDate>Sun, 26 Jun 2022 00:00:00 +0000</pubDate><guid>https://c3rb3ru5d3d53c.github.io/malware-blog/2022-07-04-bitter-apt-zxxz-backdoor/</guid><description>Introduction Bitter APT (T-APT-17/APT-C-08/Orange Yali) is a group known to operate in South Asia and is suspected to be an Indian üáÆ‚Äçüá≥ APT. They primarialy target Pakistan üáµ‚Äçüá∞, Saudi Arabia üá∏‚Äçüá¶ and China.
Analysis This will be an indepth analysis of Bitter APT&amp;rsquo;s backdoor named ZxxZ. We will cover almost every aspect of the attack chain including, exploit shellcode analysis, building our own C2 server to communicate with the malware and writing detection signatures for the community.</description></item><item><title>Qakbot/QBot Downloader</title><link>https://c3rb3ru5d3d53c.github.io/malware-blog/2020-02-12-qakbot-downloader/</link><pubDate>Wed, 12 Feb 2020 00:00:00 +0000</pubDate><guid>https://c3rb3ru5d3d53c.github.io/malware-blog/2020-02-12-qakbot-downloader/</guid><description>Situation:
I came across an interesting obfuscated sample on Any.Run.
Metadata:
db2614353dc6c29dbe323dbeafe6b781 Analysis:
The sample has a ton of comments making the file size total around ~4mb.
This was easily parsed out with sed &amp;rsquo;s/^\x27//&amp;rsquo;.
The next step is to idenify where code is evaluated which was here exECuTeglOBal sHLW(iDxY).
Changed this to WScript.Echo then also had to backtrack for a variable which defined before the evaluation.
This variable contained an array of strings which contain object names and the downloader URL, User-Agent etc.</description></item><item><title>ViperSoftx Vjw0rm Variant</title><link>https://c3rb3ru5d3d53c.github.io/malware-blog/2020-02-10-vjw0rm-vipersoftx-variant/</link><pubDate>Mon, 10 Feb 2020 00:00:00 +0000</pubDate><guid>https://c3rb3ru5d3d53c.github.io/malware-blog/2020-02-10-vjw0rm-vipersoftx-variant/</guid><description>Situation:
While watching Any.Run for interesting scripts to deobfuscate, I noted that its traffic did appear to be like other variants of vjw0rm however wasn&amp;rsquo;t sure of what else it could do.
Metadata:
Sample: 3236312b9dc691dd8b9214f08ff01e5d Analysis
The obfuscation techniques are pretty standard, the first stage deobfuscates base64 data then performs mathematic operations on it (I don&amp;rsquo;t give a crap how they work I just let it do the heavy lifting for me), interestingly the base64 string is reversed.</description></item><item><title>Mr. Robot Variant of Vjw0rm</title><link>https://c3rb3ru5d3d53c.github.io/malware-blog/2020-02-01-vjw0rm-mr-robot-variant/</link><pubDate>Sat, 01 Feb 2020 00:00:00 +0000</pubDate><guid>https://c3rb3ru5d3d53c.github.io/malware-blog/2020-02-01-vjw0rm-mr-robot-variant/</guid><description>I was monitoring Any.Run when a .js file peeked my interest due to the limited network traffic.
Analysis Metadata:
Name: 1.js MD5 : 3f438e857c45a4812dbfa331fd3b8011 The first stage decrypts a long Unicode string then calls eval on its result as seen in Figure 1.
function y(o,h) { var t;var s=&amp;quot;&amp;quot;; var d=(o+&amp;quot;&amp;quot;).split(&amp;quot;&amp;quot;); for (var i=0;i&amp;lt;d.length;i++){ t=d[i].charCodeAt(0); s+=String.fromCharCode(256-+t+(+h)); } return s; } WScript.Sleep(10000); eval(&amp;quot;eval(y(\&amp;quot;&amp;lt;long_unicode_string&amp;gt;\&amp;quot;&amp;quot;); Figure 1: Deobfuscation routine
When threat actor(s) use eval, most of the time I can easily bypass this with replacing it with console.</description></item></channel></rss>