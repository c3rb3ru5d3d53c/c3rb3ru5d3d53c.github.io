<!doctype html><html lang=en dir=ltr><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Malware Analysis and Reverse Engineering Workflow | Malware Hell</title><meta name=generator content="Hugo Eureka 0.9.3"><link rel=stylesheet href=https://c3rb3ru5d3d53c.github.io/css/eureka.min.9cec6350e37e534b0338fa9a085bf06855de3b0f2dcf857e792e5e97b07ea905d4d5513db554cbc26a9c3da622bae92d.css><script defer src=https://c3rb3ru5d3d53c.github.io/js/eureka.min.fa9a6bf6d7a50bb635b4cca7d2ba5cf3dfb095ae3798773f1328f7950028b48c17d06276594e1b5f244a25a6c969a705.js></script>
<link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&family=Noto+Serif+SC:wght@400;600;700&display=swap" as=style onload='this.onload=null,this.rel="stylesheet"'><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/styles/base16/solarized-light.min.css media=print onload='this.media="all",this.onload=null' crossorigin><script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/highlight.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/dart.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/bash.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/cpp.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/python.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/c.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/vbscript.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/powershell.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/http.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/x86asm.min.js crossorigin></script>
<link rel=stylesheet href=https://c3rb3ru5d3d53c.github.io/css/highlightjs.min.2958991528e43eb6fc9b8c4f2b8e052f79c4010718e1d1e888a777620e9ee63021c2c57ec7417a3108019bb8c41943e6.css media=print onload='this.media="all",this.onload=null'><script defer type=text/javascript src=https://c3rb3ru5d3d53c.github.io/js/fontawesome.min.9956a9fdeeb895bcca3e646ea4f943c9dfbabb5b76757ae1c2c3b3fe2ee29f21edf15c30e1b524d558b6363569a57b12.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css integrity=sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ media=print onload='this.media="all",this.onload=null' crossorigin><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js integrity=sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script defer src=https://cdn.jsdelivr.net/npm/mermaid@8.14.0/dist/mermaid.min.js integrity=sha384-atOyb0FxAgN9LyAc6PEf9BjgwLISyansgdH8/VXQH8p2o5vfrRgmGIJ2Sg22L0A0 crossorigin></script>
<link rel=icon type=image/png sizes=32x32 href=https://c3rb3ru5d3d53c.github.io/images/profile_hudffae30dddd93a90cdf89d35bb97314e_107726_32x32_fill_q75_box_center.jpg><link rel=apple-touch-icon sizes=180x180 href=https://c3rb3ru5d3d53c.github.io/images/profile_hudffae30dddd93a90cdf89d35bb97314e_107726_180x180_fill_q75_box_center.jpg><meta name=description content="A guide to my malware analysis and reverse engineering workflow."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Documents","item":"https://c3rb3ru5d3d53c.github.io/documents/"},{"@type":"ListItem","position":2,"name":"Malware Analysis and Reverse Engineering Workflow","item":"https://c3rb3ru5d3d53c.github.io/documents/malware-analysis-reversing-workflow/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://c3rb3ru5d3d53c.github.io/documents/malware-analysis-reversing-workflow/"},"headline":"Malware Analysis and Reverse Engineering Workflow | Malware Hell","datePublished":"2022-07-06T00:00:00+00:00","dateModified":"2022-07-06T00:00:00+00:00","wordCount":2339,"author":{"@type":"Person","name":"c3rb3ru5d3d53c"},"publisher":{"@type":"Person","name":"c3rb3ru5d3d53c","logo":{"@type":"ImageObject","url":"https://c3rb3ru5d3d53c.github.io/images/profile.jpg"}},"description":"A guide to my malware analysis and reverse engineering workflow."}</script><meta property="og:title" content="Malware Analysis and Reverse Engineering Workflow | Malware Hell"><meta property="og:type" content="article"><meta property="og:image" content="https://c3rb3ru5d3d53c.github.io/images/profile.jpg"><meta property="og:url" content="https://c3rb3ru5d3d53c.github.io/documents/malware-analysis-reversing-workflow/"><meta property="og:description" content="A guide to my malware analysis and reverse engineering workflow."><meta property="og:locale" content="en"><meta property="og:site_name" content="Malware Hell"><meta property="article:published_time" content="2022-07-06T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-06T00:00:00+00:00"><meta property="article:section" content="documents"><meta property="article:tag" content="malware"><meta property="article:tag" content="analysis"><meta property="article:tag" content="laboratory"><meta property="article:tag" content="lab"><meta property="article:tag" content="workflow"><meta property="og:see_also" content="https://c3rb3ru5d3d53c.github.io/documents/malware-analysis-beginner-guide/"><meta property="og:see_also" content="https://c3rb3ru5d3d53c.github.io/documents/kvm-malware-lab/"><meta property="og:see_also" content="https://c3rb3ru5d3d53c.github.io/malware-blog/2022-07-04-bitter-apt-zxxz-backdoor/"><meta property="og:see_also" content="https://c3rb3ru5d3d53c.github.io/documents/cheatsheet/"><meta property="og:see_also" content="https://c3rb3ru5d3d53c.github.io/malware-blog/2020-02-12-qakbot-downloader/"><meta property="og:see_also" content="https://c3rb3ru5d3d53c.github.io/malware-blog/2020-02-10-vjw0rm-vipersoftx-variant/"><body class="flex min-h-screen flex-col"><header class="min-h-16 pl-scrollbar bg-secondary-bg fixed z-50 flex w-full items-center shadow-sm"><div class="mx-auto w-full max-w-screen-xl"><script>let storageColorScheme=localStorage.getItem("lightDarkMode");((storageColorScheme=="Auto"||storageColorScheme==null)&&window.matchMedia("(prefers-color-scheme: dark)").matches||storageColorScheme=="Dark")&&document.getElementsByTagName("html")[0].classList.add("dark")</script><nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0"><a href=/ class="me-6 text-primary-text text-xl font-bold">Malware Hell</a>
<button id=navbar-btn class="md:hidden flex items-center px-3 py-2" aria-label="Open Navbar">
<i class="fas fa-bars"></i></button><div id=target class="hidden block md:flex md:grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20"><div class="md:flex md:h-16 text-sm md:grow pb-4 md:pb-0 border-b md:border-b-0"><a href=/malware-blog/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">Malware Blog</a>
<a href=/personal-blog/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">Personal Blog</a>
<a href=/iocs/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">IOCs</a>
<a href=https://github.com/c3rb3ru5d3d53c/signatures/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">Signatures</a>
<a href=/documents/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 selected-menu-item me-4">Documents</a></div><div class=flex><div class="relative pt-4 md:pt-0"><div class="cursor-pointer hover:text-eureka" id=lightDarkMode><i class="fas fa-adjust"></i></div><div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-30" id=is-open></div><div class="absolute flex flex-col start-0 md:start-auto end-auto md:end-0 hidden bg-secondary-bg w-48 rounded py-2 border border-tertiary-bg cursor-pointer z-40" id=lightDarkOptions><span class="px-4 py-1 hover:text-eureka" name=Light>Light</span>
<span class="px-4 py-1 hover:text-eureka" name=Dark>Dark</span>
<span class="px-4 py-1 hover:text-eureka" name=Auto>Auto</span></div></div></div></div><div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0" id=is-open-mobile></div></nav><script>let element=document.getElementById("lightDarkMode");storageColorScheme==null||storageColorScheme=="Auto"?document.addEventListener("DOMContentLoaded",()=>{window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",switchDarkMode)}):storageColorScheme=="Light"?(element.firstElementChild.classList.remove("fa-adjust"),element.firstElementChild.setAttribute("data-icon","sun"),element.firstElementChild.classList.add("fa-sun")):storageColorScheme=="Dark"&&(element.firstElementChild.classList.remove("fa-adjust"),element.firstElementChild.setAttribute("data-icon","moon"),element.firstElementChild.classList.add("fa-moon")),document.addEventListener("DOMContentLoaded",()=>{getcolorscheme(),switchBurger()})</script></div></header><main class="grow pt-16"><div class=pl-scrollbar><div class="mx-auto w-full max-w-screen-xl lg:px-4 xl:px-8"><div class="grid grid-cols-2 gap-4 lg:grid-cols-8 lg:pt-12"><div class="bg-secondary-bg col-span-2 rounded px-6 py-8 lg:col-span-6"><article class=prose><h1 class=mb-4>Malware Analysis and Reverse Engineering Workflow</h1><div class="text-tertiary-text not-prose mt-2 flex flex-row flex-wrap items-center"><div class="me-6 my-2"><i class="fas fa-calendar me-1"></i>
<span>2022-07-06</span></div><div class="me-6 my-2"><i class="fas fa-clock me-1"></i>
<span>11 min read</span></div><div class="me-6 my-2"><i class="fas fa-folder me-1"></i>
<a href=https://c3rb3ru5d3d53c.github.io/categories/malware/ class=hover:text-eureka>malware</a></div></div><p>I have noticed that there is a lot of material on individual parts of the malware analysis and reverse engineering process. However, they do not cover really what someone&rsquo;s workflow is from start to finish. This guide will be an overview of my general workflow.</p><h2 id=prerequsites>Prerequsites</h2><ul><li>Ensure you have finished setting up your <a href=/documents/kvm-malware-lab/>malware lab</a></li><li>This guide is not how everyone does it, everyone will refine their own workflow, which works best for them overtime.</li></ul><h2 id=methodology>Methodology</h2><p>When working on malware it is good to have a methodology to guide your operations. Without an overall methodology, your work will fall flat as you have no purpose. It is a cool emerging field and can make your company look awesome, but at the same time, reverse engineering is time consuming and very expensive. If extra care is not given to an overall direction you can become very ineffective. People who do not know about the technical challenges malware analysis and reverse engineering pose, believe that you can send them a report on a fully reversed malware sample in a couple of hours. It is up to us to educate them that this is not the case, as always things are usually much more complex than they seem. Based on the complexity of a malware sample it could take minutes, hours, days, months, years, it really just depends!</p><p><img src=images/0.png alt=purpose></p><p>Depending on where you work there will often be different methodologies to how they strategize this process. Because of this, do not be suprised when the methodology depicted in this guide is different elsewhere.</p><h3 id=purpose-and-output>Purpose and Output</h3><p>There are many purposes you can have when performing analysis like this.</p><ul><li>Detection Signatures</li><li>Malware Configuration Extractors (Intelligence)</li><li>Automated Unpacking</li><li>Tracking Threat Actors</li><li>Writing Technical Reports</li></ul><p>There are certainly other potential usecases for this kind of work.</p><p>However, these would be the usecases for most.</p><h3 id=behavior>Behavior</h3><p>When analyzing malware it is important to focus on its behavior. This tells us exactly what operations we can expect the malware to perform once its in a target environment.</p><h4 id=endpoint>Endpoint</h4><p>Endpoint behavior includes but is not limited to the following properties.</p><ul><li>Process Creation</li><li>File Create and Delete</li><li>Registry Keys</li><li>DNS</li><li>TCP Communication</li><li>Code Injection</li></ul><h4 id=network>Network</h4><p>Although there are some points regarding networking in the Endpoint section, this section is about full packet inspection. This is how the malware communicates, not just to a domain or IP address but the contents of that communication and how it behaves.</p><h3 id=detection>Detection</h3><p>One of the things I pride myself on is writing meaningful detection. Imagine going to the doctor because you are feeling sick. If the doctor checks you over and only confirms you are sick or gives you a vague diagnosis without more details, it creates a poor customer experience. In the cybersecurity industry we can attribute this experience to looking at VirusTotal antivirus detection names. When I write detection, i create heuristic as well as classification signatures. This ensures we can catch more malware at a larger scale but also catch the ones we already know about and provide that diagnosis people are looking for.</p><p>When executing this detection methodology, I focus on the Tools and Techniques Tactics and Procedures (TTPs). A great reference diagram for this is the pyramid of pain shown below.</p><p><img src=images/1.png alt=pyramid-of-pain></p><p>There is importance for intelligence like IP addresses hash values, domain names and network/host artifacts. However, this does not lie so much in detection, it lies more in verification of behaviors as observed by tier 1 SOC analysts, as well as, tracking threat actor infrastructure.</p><h2 id=process>Process</h2><p>When we work on malware analysis and reverse engineering it is important to have a process to keep you organized in your work. Without an overall process, it will be easy to become lost or have to redo work you have already completed.</p><p>It is also important that we are cognizant about the time complexity of our process. If we obtain our goal reasonably within the first stages of this pyramid, you must justify the expense of going further up the pyramid.</p><p><img src=images/2.png alt=time-complexity></p><p>Time is money and reverse engineering code takes a long time but can come with additional benifits. Again, without a clear methodology and direction you could waste a lot of time and money.</p><h3 id=overview>Overview</h3><p>The following graph provides an overview of the general process I follow.</p><div class=mermaid>graph TD
subgraph Malware Analysis
0(Identify Filetype) & 1(Analysis) & 2(Malicious Intent?) & 3(end)
	end
	subgraph Reverse Engineering
4(Triage Review) & 5(Reversing) & 6(Scoped Result) & 7(end)
	end
	 0 -->|Select Tooling| 1
1 -->|static/dynamic|2
2-->|yes|4
2-->|no|3
4-->|scope of work|5
5-->|process|6
6-->7</div><p>The graph above can be descrived as follows.</p><ul><li>Triage<ul><li>Identify Filetype<ul><li>Determine which tools to use for further analysis</li></ul></li><li>Malware Analysis<ul><li>Static Analysis<ul><li>Use static tools based on filetype</li></ul></li><li>Dynamic Analysis<ul><li>Execute the malware and observe its behavior</li></ul></li></ul></li><li>Malicious Intent<ul><li>Determine if the sample has malicious intent</li></ul></li></ul></li><li>Reversing<ul><li>Triage<ul><li>Determine the scope of work</li></ul></li><li>Actual Reversing</li><li>Scoped Result</li></ul></li></ul><h3 id=malware-analysis>Malware Analysis</h3><p>Malware analysis is a process to triage the beginning stages is to ensure that we have a high level overview of the sample that we will use later for reverse engineering. This saves us time in the process as it provides reliable situational awareness.</p><h4 id=identify-filetype>Identify Filetype</h4><p>We need to determine what kind of file we are working with as it will aid us in determing the tooling we will be using moving forward.</p><p>Suggested tools.</p><ul><li><a href=https://github.com/horsicq/Detect-It-Easy>Detect it Easy</a></li><li>Linux <em>file</em> command</li><li>Binwalk</li></ul><pre><code class=language-bash>sudo apt install -y binwalk
</code></pre><h4 id=analysis>Analysis</h4><p>The malware analysis stage for me depicts the part of the process where we start investigating for malicious intent. This process includes analysis of the sample using both static and dynamic analysis. However, it is a more surface level approach than reverse engineering.</p><h5 id=static>Static</h5><p>Before we can perform static analysis we must be able to understand what it means.</p><blockquote><p>Static program analysis is the analysis of computer software performed without executing any programs, in contrast with dynamic analysis, which is performed on programs during their execution. - <a href=https://en.wikipedia.org/wiki/Static_program_analysis>https://en.wikipedia.org/wiki/Static_program_analysis</a></p></blockquote><p>This means we perform analysis without executing the sample.</p><p>Suggested tools.</p><ul><li><a href=https://www.winitor.com/download>PEStudio</a></li><li><a href=https://github.com/hasherezade/pe-bear-releases>PEBear</a></li><li><a href=https://github.com/horsicq/Detect-It-Easy>Detect it Easy</a></li><li><a href=https://www.7-zip.org/>7zip</a></li><li><a href=https://github.com/VirusTotal/yara>YARA</a></li><li><a href=https://www.virustotal.com/gui/home/upload>VirusTotal</a></li><li><a href=https://bazaar.abuse.ch/>MalwareBazaar</a></li></ul><p>What we are looking for are indicators that clearly show malicious intent.</p><h5 id=dynamic>Dynamic</h5><p>Before we can perform dynamic analysis we must be able to understand its meaning first.</p><blockquote><p>Dynamic program analysis is the analysis of computer software that is performed by executing programs on a real or virtual processor. For dynamic program analysis to be effective, the target program must be executed with sufficient test inputs to cover almost all possible outputs. <a href=https://en.wikipedia.org/wiki/Dynamic_program_analysis>https://en.wikipedia.org/wiki/Dynamic_program_analysis</a></p></blockquote><p>Now there are two types of dynamic analysis I like to do, the first one is automated dynamic analysis.</p><p>For automated dynamic analysis I will submit the sample I have to a sandbox service or my own sandbox system. Let us first understand what sanboxing is at a high level with the following definition.</p><blockquote><p>Sandboxing is <strong>used to test code or applications that could be malicious before serving it up to critical devices</strong>. In cybersecurity, sandboxing is used as a method to test software which would end up being categorized as “safe” or “unsafe” after the test. - <a href="https://blog.malwarebytes.com/awareness/2020/09/sandbox-in-security/#:~:text=Malware%20detection%20and%20sandboxing&text=Sandboxing%20is%20used%20to%20test,%E2%80%9Cunsafe%E2%80%9D%20after%20the%20test">Malware Bytes</a></p></blockquote><p>Now that we understand what sandboxing means I recommend the following resources.</p><ul><li><a href=https://app.any.run/submissions/>AnyRun</a></li><li><a href=https://www.hybrid-analysis.com/>HybridAnalysis</a></li><li><a href=https://capesandbox.com/analysis/>Cape Sandbox</a></li><li><a href=https://tria.ge/>Triage</a></li><li><a href=https://www.joesandbox.com/#windows>Joe Sandbox</a></li></ul><p>Once you execute the sample in a sandbox, you will want to hunt for malicious intent.</p><p>The other type of dynamic analysis is to perform it manually on your own lab machine. To monitor the activity you can use tools like Wireshark for network and Procmon for endpoint behaviors. This type of dynamic analysis can involve manipulating the malware by responding to it over the network or placing files or other artifacts in places it needs them to enable further execution.</p><h4 id=malicious-intent>Malicious Intent</h4><p>After we finish our static and dynamic malware analysis we need to indicate if the sample has malicious intent or not. If we do determine it has malicious intent, we have some decisions on tasks we need to make.</p><ul><li>Refer to the <em>Purposes and Output</em> section and complete what is needed</li><li>Escalate to Reverse Engineering if needed</li></ul><p>Additional refrences for malicious intent.</p><ul><li><a href=https://attack.mitre.org/>Mire</a></li><li><a href=https://lolbas-project.github.io/>LOLBAS</a></li></ul><p>Depending on your scope of work and standard operating procedures and overall strategy, these will be the tasks you will need to decide you will complete or not.</p><p><em>NOTE: It is not always nessassary to escalate to reverse engineering, it depends again on the scope of work you receive and the complexity of the malware and the results you need. So the process can totally stop here and that&rsquo;s okay too!</em></p><h3 id=reverse-engineering>Reverse Engineering</h3><p>Reverse engineering can be defined as follows.</p><blockquote><p>Reverse engineering is a process or method through which one attempts to understand through deductive reasoning how a previously made device, process, system, or piece of software accomplishes a task with very little insight into exactly how it does so. - <a href=https://en.wikipedia.org/wiki/Reverse_engineering>https://en.wikipedia.org/wiki/Reverse_engineering</a></p></blockquote><h4 id=triage-review>Triage Review</h4><p>This kind of triage is very different to triage for malware analysis. The goal of triage with reverse engineering is to use the information to help you identify areas of key interest in the malicious binary. For example, if the malware analysis triage notes indicate that the malware uses <em>ws2_32.dll</em> for communication, we can look into cross references for these API calls in the binary.</p><p>Once we have mapped out what tasks we wish to perform, we can move to the next step.</p><h4 id=reversing>Reversing</h4><p>In this stage we start actually reverse engineering the malware, typically we will use tools like Ghidra, IDA Pro and DNSpy to decompile the binary.</p><p>We will use these decompilers to create pseudo code.</p><blockquote><p>In computer science, pseudocode is a plain language description of the steps in an algorithm or another system. Pseudocode often uses structural conventions of a normal programming language, but is intended for human reading rather than machine reading.</p></blockquote><p>This code is an approximation of what the original code may look like.</p><p>It is up to us to clean this pseudo code up so we can make it more understandable for us humans to read.</p><p>This is a whole process of its own and we will not cover these specific principals in this workflow guide. We will save this for the reverse engineering guide.</p><p>Once completed, refer to the <em>Purposes and Output</em> section and complete what is needed.</p><h2 id=tips-and-tricks>Tips and Tricks</h2><p>Here are some basic tips and tricks to help you stay organized in this process.</p><h3 id=standardized-analysis-folder-structure>Standardized Analysis Folder Structure</h3><p>When I start a new task like this I create a folder that contains the following structure.</p><ul><li>docs - a folder containing documentation from public articles to and own notes</li><li>pcaps - packet capture files</li><li>samples - samples from the analysis, which may include multiple stages</li><li>scripts - scripts that help me automate the process</li><li>projects - contains project files for Ghidra, IDA and more</li></ul><p>With this folder structure I&rsquo;m able to know where I am and where I&rsquo;m going.</p><h3 id=standardized-decompiler-code-style>Standardized Decompiler Code Style</h3><p>When working in Ghidra or IDA Pro it&rsquo;s important for me to standardize how I name functions and variables in the pseudo code. Personally I keep this consistent with the standards as deemed by the operating system&rsquo;s programming guides. This ensures that the documentation and the style guidelines is easily accessable and understood by everyone.</p><h3 id=comments>Comments</h3><p>When working in Ghidra, IDA Pro or any other tool that allows you to make comments. Write lots of comments. This will keep you organized so that you know exactly where you are. If there are note taking features in the software you are using, take advantage of it.</p><h3 id=taking-notes>Taking Notes</h3><p>As I work through these processes, I will keep notes, typically in markdown format to keep myself organized. There are many different tools you can use to do this. However, I use Obsidian at the moment due to it&rsquo;s wide variety of features.</p><h2 id=sharing-your-work-tlp>Sharing your Work (TLP)</h2><p>When working with malware it is always a good idea to understand what the sharing rights of the samples you are working on.</p><table><thead><tr><th>TLP</th><th>Usage</th><th>Sharing</th></tr></thead><tbody><tr><td>TLP:RED</td><td>Sources may use TLP:RED when information cannot be effectively acted upon by additional parties, and could lead to impacts on a party&rsquo;s privacy, reputation, or operations if misused.</td><td>Recipients may not share TLP:RED information with any parties outside of the specific exchange, meeting, or conversation in which it was originally disclosed. In the context of a meeting, for example, TLP:RED information is limited to those present at the meeting. In most circumstances, TLP:RED should be exchanged verbally or in person.</td></tr><tr><td>TLP:AMBER</td><td>Sources may use TLP:AMBER when information requires support to be effectively acted upon, yet carries risks to privacy, reputation, or operations if shared outside of the organizations involved.</td><td>Recipients may only share TLP:AMBER information with members of their own organization, and with clients or customers who need to know the information to protect themselves or prevent further harm. Sources are at liberty to specify additional intended limits of the sharing: these must be adhered to.</td></tr><tr><td>TLP:GREEN</td><td>Sources may use TLP:GREEN when information is useful for the awareness of all participating organizations as well as with peers within the broader community or sector.</td><td>Recipients may share TLP:GREEN information with peers and partner organizations within their sector or community, but not via publicly accessible channels. Information in this category can be circulated widely within a particular community. TLP:GREEN information may not be released outside of the community.</td></tr><tr><td>TLP:WHITE</td><td>Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release.</td><td>Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction.</td></tr></tbody></table><p>When we share our reports, signatures and more we will typically apply Traffic Light Protocol (TLP) to the content. This way other people in the community can understand how they are able to use and share the content.</p><h2 id=conclusion>Conclusion</h2><p>When starting out for the first time it can be a daunting task even to begin understanding what someone&rsquo;s workflow may look like beginning to end. This guide hopefully helps you create your own workflow that makes sense for you.</p></article><div class=my-4><a href=https://c3rb3ru5d3d53c.github.io/tags/malware/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#malware</a>
<a href=https://c3rb3ru5d3d53c.github.io/tags/analysis/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#analysis</a>
<a href=https://c3rb3ru5d3d53c.github.io/tags/laboratory/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#laboratory</a>
<a href=https://c3rb3ru5d3d53c.github.io/tags/lab/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#lab</a>
<a href=https://c3rb3ru5d3d53c.github.io/tags/workflow/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#workflow</a></div><div class=py-2><div class="my-8 flex flex-col items-center md:flex-row"><a href=https://c3rb3ru5d3d53c.github.io/authors/c3rb3ru5d3d53c/ class="md:me-4 text-primary-text h-24 w-24"><img src=https://c3rb3ru5d3d53c.github.io/images/profile.jpg class="bg-primary-bg w-full rounded-full" alt=Avatar></a><div class="mt-4 w-full md:mt-0 md:w-auto"><a href=https://c3rb3ru5d3d53c.github.io/authors/c3rb3ru5d3d53c/ class="mb-2 block border-b pb-1 text-lg font-bold"><h3>c3r3b3ru5d3d53c</h3></a><span class="block pb-2">I have acquired over my career, skills that make me a nightmare for threat actors.</span>
<a href=mailto:c3rb3ru5d3d53c@gmail.com class=me-2><i class="fas fa-envelope"></i></a>
<a href=https://twitter.com/c3rb3ru5d3d53c class=me-2><i class="fab fa-twitter"></i></a>
<a href=https://github.com/c3rb3ru5d3d53c class=me-2><i class="fab fa-github"></i></a>
<a href=https://www.youtube.com/channel/UCk9BugRahSWgPLYOAA3QH4w class=me-2><i class="fab fa-youtube"></i></a></div></div></div><div class="-mx-2 mt-4 flex flex-col border-t px-2 pt-4 md:flex-row md:justify-between"><div></div><div class="mt-4 md:mt-0 md:text-right"><span class="text-primary-text block font-bold">Next</span>
<a href=https://c3rb3ru5d3d53c.github.io/documents/cheatsheet/ class=block>CheatSheet</a></div></div></div><div class=col-span-2><div class="bg-primary-bg
prose sticky top-16 z-10 hidden px-6 py-4 lg:block"><h3>On This Page</h3></div><div class="sticky-toc hidden px-6 pb-6 lg:block"><nav id=TableOfContents><ul><li><a href=#prerequsites>Prerequsites</a></li><li><a href=#methodology>Methodology</a><ul><li><a href=#purpose-and-output>Purpose and Output</a></li><li><a href=#behavior>Behavior</a><ul><li><a href=#endpoint>Endpoint</a></li><li><a href=#network>Network</a></li></ul></li><li><a href=#detection>Detection</a></li></ul></li><li><a href=#process>Process</a><ul><li><a href=#overview>Overview</a></li><li><a href=#malware-analysis>Malware Analysis</a><ul><li><a href=#identify-filetype>Identify Filetype</a></li><li><a href=#analysis>Analysis</a><ul><li><a href=#static>Static</a></li><li><a href=#dynamic>Dynamic</a></li></ul></li><li><a href=#malicious-intent>Malicious Intent</a></li></ul></li><li><a href=#reverse-engineering>Reverse Engineering</a><ul><li><a href=#triage-review>Triage Review</a></li><li><a href=#reversing>Reversing</a></li></ul></li></ul></li><li><a href=#tips-and-tricks>Tips and Tricks</a><ul><li><a href=#standardized-analysis-folder-structure>Standardized Analysis Folder Structure</a></li><li><a href=#standardized-decompiler-code-style>Standardized Decompiler Code Style</a></li><li><a href=#comments>Comments</a></li><li><a href=#taking-notes>Taking Notes</a></li></ul></li><li><a href=#sharing-your-work-tlp>Sharing your Work (TLP)</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><script>window.addEventListener("DOMContentLoaded",()=>{enableStickyToc()})</script></div><div class="bg-secondary-bg prose col-span-2 rounded p-6 lg:col-span-6"><h3>See Also</h3><a href=https://c3rb3ru5d3d53c.github.io/documents/malware-analysis-beginner-guide/ class=no-underline>Malware Analysis for Beginners</a><br><a href=https://c3rb3ru5d3d53c.github.io/documents/kvm-malware-lab/ class=no-underline>KVM Malware Lab Guide</a><br><a href=https://c3rb3ru5d3d53c.github.io/malware-blog/2022-07-04-bitter-apt-zxxz-backdoor/ class=no-underline>Making Fun of Your APT Malware - Bitter APT Using ZxxZ Backdoor to Target Pakistan Public Accounts Committee</a><br><a href=https://c3rb3ru5d3d53c.github.io/documents/cheatsheet/ class=no-underline>CheatSheet</a><br><a href=https://c3rb3ru5d3d53c.github.io/malware-blog/2020-02-12-qakbot-downloader/ class=no-underline>Qakbot/QBot Downloader</a><br><a href=https://c3rb3ru5d3d53c.github.io/malware-blog/2020-02-10-vjw0rm-vipersoftx-variant/ class=no-underline>ViperSoftx Vjw0rm Variant</a><br></div></div><script>document.addEventListener("DOMContentLoaded",()=>{hljs.highlightAll()})</script></div></div></main><footer class=pl-scrollbar><div class="mx-auto w-full max-w-screen-xl"><div class="text-center p-6 pin-b"><p class="text-sm text-tertiary-text">&copy; 2022 <a href=https://twitter.com/c3rb3ru5d3d53c>c3rb3ru5d3d53c</a>
&#183; Powered by the <a href=https://github.com/wangchucheng/hugo-eureka class=hover:text-eureka>Eureka</a> theme for <a href=https://gohugo.io class=hover:text-eureka>Hugo</a></p></div></div></footer></body></html>