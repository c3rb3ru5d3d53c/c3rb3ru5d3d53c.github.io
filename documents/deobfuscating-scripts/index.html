<!doctype html><html lang=en dir=ltr><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Deobfuscating Scripts | Malware Hell</title><meta name=generator content="Hugo Eureka 0.9.3"><link rel=stylesheet href=https://c3rb3ru5d3d53c.github.io/css/eureka.min.9cec6350e37e534b0338fa9a085bf06855de3b0f2dcf857e792e5e97b07ea905d4d5513db554cbc26a9c3da622bae92d.css><script defer src=https://c3rb3ru5d3d53c.github.io/js/eureka.min.fa9a6bf6d7a50bb635b4cca7d2ba5cf3dfb095ae3798773f1328f7950028b48c17d06276594e1b5f244a25a6c969a705.js></script>
<link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&family=Noto+Serif+SC:wght@400;600;700&display=swap" as=style onload='this.onload=null,this.rel="stylesheet"'><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/styles/base16/solarized-light.min.css media=print onload='this.media="all",this.onload=null' crossorigin><script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/highlight.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/dart.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/bash.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/cpp.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/python.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/c.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/vbscript.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/powershell.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/http.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/x86asm.min.js crossorigin></script>
<link rel=stylesheet href=https://c3rb3ru5d3d53c.github.io/css/highlightjs.min.2958991528e43eb6fc9b8c4f2b8e052f79c4010718e1d1e888a777620e9ee63021c2c57ec7417a3108019bb8c41943e6.css media=print onload='this.media="all",this.onload=null'><script defer type=text/javascript src=https://c3rb3ru5d3d53c.github.io/js/fontawesome.min.9956a9fdeeb895bcca3e646ea4f943c9dfbabb5b76757ae1c2c3b3fe2ee29f21edf15c30e1b524d558b6363569a57b12.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css integrity=sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ media=print onload='this.media="all",this.onload=null' crossorigin><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js integrity=sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script defer src=https://cdn.jsdelivr.net/npm/mermaid@8.14.0/dist/mermaid.min.js integrity=sha384-atOyb0FxAgN9LyAc6PEf9BjgwLISyansgdH8/VXQH8p2o5vfrRgmGIJ2Sg22L0A0 crossorigin></script>
<link rel=icon type=image/png sizes=32x32 href=https://c3rb3ru5d3d53c.github.io/images/profile_hudffae30dddd93a90cdf89d35bb97314e_107726_32x32_fill_q75_box_center.jpg><link rel=apple-touch-icon sizes=180x180 href=https://c3rb3ru5d3d53c.github.io/images/profile_hudffae30dddd93a90cdf89d35bb97314e_107726_180x180_fill_q75_box_center.jpg><meta name=description content="A guide to deobfuscation of scripts for malware analysts."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Documents","item":"https://c3rb3ru5d3d53c.github.io/documents/"},{"@type":"ListItem","position":2,"name":"Deobfuscating Scripts","item":"https://c3rb3ru5d3d53c.github.io/documents/deobfuscating-scripts/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://c3rb3ru5d3d53c.github.io/documents/deobfuscating-scripts/"},"headline":"Deobfuscating Scripts | Malware Hell","datePublished":"2022-07-09T00:00:00+00:00","dateModified":"2022-07-09T00:00:00+00:00","wordCount":1621,"author":{"@type":"Person","name":"c3rb3ru5d3d53c"},"publisher":{"@type":"Person","name":"c3rb3ru5d3d53c","logo":{"@type":"ImageObject","url":"https://c3rb3ru5d3d53c.github.io/images/profile.jpg"}},"description":"A guide to deobfuscation of scripts for malware analysts."}</script><meta property="og:title" content="Deobfuscating Scripts | Malware Hell"><meta property="og:type" content="article"><meta property="og:image" content="https://c3rb3ru5d3d53c.github.io/images/profile.jpg"><meta property="og:url" content="https://c3rb3ru5d3d53c.github.io/documents/deobfuscating-scripts/"><meta property="og:description" content="A guide to deobfuscation of scripts for malware analysts."><meta property="og:locale" content="en"><meta property="og:site_name" content="Malware Hell"><meta property="article:published_time" content="2022-07-09T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-09T00:00:00+00:00"><meta property="article:section" content="documents"><meta property="article:tag" content="malware"><meta property="article:tag" content="analysis"><meta property="article:tag" content="laboratory"><meta property="article:tag" content="lab"><meta property="article:tag" content="deobfuscation"><meta property="article:tag" content="scripting"><meta property="og:see_also" content="https://c3rb3ru5d3d53c.github.io/documents/malware-sample-handling/"><meta property="og:see_also" content="https://c3rb3ru5d3d53c.github.io/documents/malware-analysis-reversing-workflow/"><meta property="og:see_also" content="https://c3rb3ru5d3d53c.github.io/documents/malware-analysis-beginner-guide/"><meta property="og:see_also" content="https://c3rb3ru5d3d53c.github.io/documents/kvm-malware-lab/"><meta property="og:see_also" content="https://c3rb3ru5d3d53c.github.io/malware-blog/2022-07-04-bitter-apt-zxxz-backdoor/"><meta property="og:see_also" content="https://c3rb3ru5d3d53c.github.io/documents/cheatsheet/"><body class="flex min-h-screen flex-col"><header class="min-h-16 pl-scrollbar bg-secondary-bg fixed z-50 flex w-full items-center shadow-sm"><div class="mx-auto w-full max-w-screen-xl"><script>let storageColorScheme=localStorage.getItem("lightDarkMode");((storageColorScheme=="Auto"||storageColorScheme==null)&&window.matchMedia("(prefers-color-scheme: dark)").matches||storageColorScheme=="Dark")&&document.getElementsByTagName("html")[0].classList.add("dark")</script><nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0"><a href=/ class="me-6 text-primary-text text-xl font-bold">Malware Hell</a>
<button id=navbar-btn class="md:hidden flex items-center px-3 py-2" aria-label="Open Navbar">
<i class="fas fa-bars"></i></button><div id=target class="hidden block md:flex md:grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20"><div class="md:flex md:h-16 text-sm md:grow pb-4 md:pb-0 border-b md:border-b-0"><a href=/malware-blog/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">Malware Blog</a>
<a href=/personal-blog/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">Personal Blog</a>
<a href=/iocs/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">IOCs</a>
<a href=https://github.com/c3rb3ru5d3d53c/signatures/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">Signatures</a>
<a href=/documents/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 selected-menu-item me-4">Documents</a></div><div class=flex><div class="relative pt-4 md:pt-0"><div class="cursor-pointer hover:text-eureka" id=lightDarkMode><i class="fas fa-adjust"></i></div><div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-30" id=is-open></div><div class="absolute flex flex-col start-0 md:start-auto end-auto md:end-0 hidden bg-secondary-bg w-48 rounded py-2 border border-tertiary-bg cursor-pointer z-40" id=lightDarkOptions><span class="px-4 py-1 hover:text-eureka" name=Light>Light</span>
<span class="px-4 py-1 hover:text-eureka" name=Dark>Dark</span>
<span class="px-4 py-1 hover:text-eureka" name=Auto>Auto</span></div></div></div></div><div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0" id=is-open-mobile></div></nav><script>let element=document.getElementById("lightDarkMode");storageColorScheme==null||storageColorScheme=="Auto"?document.addEventListener("DOMContentLoaded",()=>{window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",switchDarkMode)}):storageColorScheme=="Light"?(element.firstElementChild.classList.remove("fa-adjust"),element.firstElementChild.setAttribute("data-icon","sun"),element.firstElementChild.classList.add("fa-sun")):storageColorScheme=="Dark"&&(element.firstElementChild.classList.remove("fa-adjust"),element.firstElementChild.setAttribute("data-icon","moon"),element.firstElementChild.classList.add("fa-moon")),document.addEventListener("DOMContentLoaded",()=>{getcolorscheme(),switchBurger()})</script></div></header><main class="grow pt-16"><div class=pl-scrollbar><div class="mx-auto w-full max-w-screen-xl lg:px-4 xl:px-8"><div class="grid grid-cols-2 gap-4 lg:grid-cols-8 lg:pt-12"><div class="bg-secondary-bg col-span-2 rounded px-6 py-8 lg:col-span-6"><article class=prose><h1 class=mb-4>Deobfuscating Scripts</h1><div class="text-tertiary-text not-prose mt-2 flex flex-row flex-wrap items-center"><div class="me-6 my-2"><i class="fas fa-calendar me-1"></i>
<span>2022-07-09</span></div><div class="me-6 my-2"><i class="fas fa-clock me-1"></i>
<span>8 min read</span></div><div class="me-6 my-2"><i class="fas fa-folder me-1"></i>
<a href=https://c3rb3ru5d3d53c.github.io/categories/malware/ class=hover:text-eureka>malware</a></div></div><p>I reached out on Twitter asking for suggestions on new topics to cover.</p><p>One of these topics was on deobfuscation of scripts. This is a great topic as this skill can generally be learned by anyone who understands writing code or scripts. I&rsquo;ll cover more advanced topics as I move forward with these guides.</p><p><img src=images/0.jpg alt=deobfuscation></p><p><em>NOTE: This guide does not cover all aspects of deobfuscation. However, once you have finished reading and practicing the concepts in this guide, you will be able to build some of your own techniques to better expand your skills.</em></p><h2 id=prerequisites>Prerequisites</h2><p>In order to begin learning about deobfuscation, we must first understand what obfuscation is.</p><blockquote><p>Obfuscation - The action of making something obscure, unclear, or unintelligible.</p></blockquote><p>In malware analysis and reverse engineering, deobfuscation is the exact opposite. It is to make something clear and intelligible.</p><p>The other knowledge required to understand obfuscation and deobfuscation of scripts, is to understand the scripting language the malware you are working on is obfuscated with. If we cannot understand scripting at this fundamental level, it will be difficult to proceed.</p><h3 id=scripting-languages>Scripting Languages</h3><p>Each operating system will typically have its own set of scripting languages that are popular to automate tasks. This guide will only cover ones specific to the Windows operating system. However, more scripting languages and tips maybe added later.</p><blockquote><p>A scripting language or script language is a programming language for a runtime system that automates the execution of tasks that would otherwise be performed individually by a human operator. Scripting languages are usually interpreted at runtime rather than compiled. - <a href=https://en.wikipedia.org/wiki/Scripting_language>Wikipedia</a></p></blockquote><h3 id=component-object-model-com>Component Object Model (COM)</h3><p>In the Windows operating system, we cannot talk about scripting until we discuss the Component Object Model (COM) interface.</p><blockquote><p>COM is a platform-independent, distributed, object-oriented system for creating binary software components that can interact. COM is the foundation technology for Microsoft&rsquo;s OLE (compound documents) and ActiveX (Internet-enabled components) technologies. - <a href=https://docs.microsoft.com/en-us/windows/win32/com/component-object-model--com--portal>Microsoft</a></p></blockquote><p>To get a list of COM Objects, we can use the following <a href=https://en.wikipedia.org/wiki/PowerShell>PowerShell</a> script.</p><pre><code class=language-powershell>function Get-ComObjects {
	# Get an Object Array of COM Object names and GUIDs
	$output = @();
	Get-ChildItem -Path 'REGISTRY::HKey_Classes_Root\clsid\*\progid' | foreach {
		if ($_.name -match &quot;[A-F0-9]{8}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{12}&quot;){
			$output += @{GUID = $matches[0]; COMObject = $_.GetValue('')};
		}
	}
	return $output;
 }
</code></pre><p>With this function, we can print all objects.</p><pre><code class=language-powershell>Get-ComObjects | foreach {
	$_ | Format-Table
}
</code></pre><p>We can also query by the object GUID or the name of the COM object.</p><pre><code class=language-powershell>Get-ComObjects | foreach {
	if ($_.COMObject -match &quot;^Scripting&quot;){
		$message = &quot;{0},{1}&quot; -f $_.GUID, $_.COMObject;
		Write-Host $message;
	}
}
</code></pre><p>The documentation and references for COM is sparse on MSDN, which can be a barrier for beginners.</p><p>The following is a list of common tools we use to enumerate COM objects for malware analysis.</p><ul><li><a href=https://github.com/tyranid/oleviewdotnet>OLEViewDotNET</a></li><li><a href=https://www.japheth.de/Download/COMView.zip>OLEView</a></li></ul><p>Once we have the COM names, we can use PowerShell to list the methods available to us.</p><pre><code class=language-powershell>New-Object -ComObject &quot;Scripting.FileSystemObject&quot; | Get-Member
   TypeName: System.__ComObject#{2a0b9d10-4b87-11d3-a97a-00104b365c9f}

Name                MemberType Definition
----                ---------- ----------
BuildPath           Method     string BuildPath (string, string)
CopyFile            Method     void CopyFile (string, string, bool)
CopyFolder          Method     void CopyFolder (string, string, bool)
CreateFolder        Method     IFolder CreateFolder (string)
CreateTextFile      Method     ITextStream CreateTextFile (string, bool, bool)
DeleteFile          Method     void DeleteFile (string, bool)
DeleteFolder        Method     void DeleteFolder (string, bool)
DriveExists         Method     bool DriveExists (string)
FileExists          Method     bool FileExists (string)
FolderExists        Method     bool FolderExists (string)
GetAbsolutePathName Method     string GetAbsolutePathName (string)
GetBaseName         Method     string GetBaseName (string)
GetDrive            Method     IDrive GetDrive (string)
GetDriveName        Method     string GetDriveName (string)
GetExtensionName    Method     string GetExtensionName (string)
GetFile             Method     IFile GetFile (string)
GetFileName         Method     string GetFileName (string)
GetFileVersion      Method     string GetFileVersion (string)
GetFolder           Method     IFolder GetFolder (string)
GetParentFolderName Method     string GetParentFolderName (string)
GetSpecialFolder    Method     IFolder GetSpecialFolder (SpecialFolderConst)
GetStandardStream   Method     ITextStream GetStandardStream (StandardStreamTypes, bool)
GetTempName         Method     string GetTempName ()
MoveFile            Method     void MoveFile (string, string)
MoveFolder          Method     void MoveFolder (string, string)
OpenTextFile        Method     ITextStream OpenTextFile (string, IOMode, bool, Tristate)
Drives              Property   IDriveCollection Drives () {get}
</code></pre><p>What is great about the COM interface descriptions in PowerShell using <em>Get-Member</em>, we can see the types of arguments these methods expect.</p><h2 id=common-techniques>Common Techniques</h2><p>In general, there are techniques that are used all throughout obfuscation of scripts. These can apply to almost any scripting language, and we should be aware of them.</p><h3 id=code-evaluation>Code Evaluation</h3><p>Functions that can be called to directly evaluate code are an excellent tool for malware authors. An example of this can be as follows.</p><pre><code class=language-js>var code = &quot;alert('Hello World');&quot;;
eval(code);
</code></pre><p>This can be done with decoding and decryption to hide the true intent of the code.</p><p>Evaluation of code is one of the first things I look for when attempting to deobfuscate a script.</p><p>We can deobfuscate this script by performing the following.</p><pre><code class=language-js>var code = &quot;alert('Hello World');&quot;;
console.log(code);
</code></pre><p>We simply changed the <em>eval</em> function to <em>console.log</em> to print out the code instead of executing it.</p><p>Again, one of the first things we typically look for.</p><h3 id=comments>Comments</h3><p>To add variation and to slow malware analysts down, malware authors will sometimes insert comments all throughout their scripts. This can make the task of deobfuscation annoying if you do not remove the comments.</p><h3 id=garbage-code>Garbage Code</h3><p>When deobfuscating scripts, we will almost always do our best to ensure that the code that we are looking at is referenced or run at all. It is not uncommon for the code authors to create a large amount of useless code. Again, their job is too slow you down.</p><h3 id=decoding-and-decryption>Decoding and Decryption</h3><p>To store obfuscated code, it is common for the authors to store code in an encrypted or encoded state. Executing the code to perform the decoding or decryption for us is usually the preferred method.</p><p>Some common encoding and encryption techniques are as follows.</p><ul><li><a href=https://en.wikipedia.org/wiki/Base64>Base64</a></li><li><a href=https://en.wikipedia.org/wiki/XOR_cipher>XOR</a></li><li><a href=https://en.wikipedia.org/wiki/Hexadecimal>Hex</a></li><li><a href=https://en.wikipedia.org/wiki/RC4>RC4</a></li><li><a href=https://en.wikipedia.org/wiki/RSA_(cryptosystem)>RSA</a></li><li><a href=https://en.wikipedia.org/wiki/Advanced_Encryption_Standard>AES</a></li></ul><p>Of these, you should be able to visually recognize Base64, XOR and Hex.</p><p>There are of course many more. However, these should be enough to get you started.</p><h3 id=concatenation>Concatenation</h3><p>Another technique malware authors like to use is concatenation. This is usually applied to strings in order to make them difficult to read. An example can be seen below.</p><pre><code class=language-js>var message = &quot;H&quot; + &quot;e&quot; + &quot;l&quot; + &quot;l&quot; + &quot;o&quot;;
console.log(message);
</code></pre><p>Depending on the scripting language the sample you are analyzing is, you will want to understand string concatenation for that specific language.</p><h3 id=additional-stages>Additional Stages</h3><p>There are cases where the malware author will decide to split their obfuscated scripts into multiple stages. This usually includes downloading additional obfuscated scripts or payloads from the internet. These kinds of payloads have been observed being hosted on Discord, Google Drive, Pastebin, Dropbox, GitHub, GitLab and more. Anywhere that users can upload content under their control on the internet, this is possible.</p><h3 id=upper-and-lower-case>Upper and Lower Case</h3><p>Microsoft has decided that case is not important in PowerShell as well as other scripting languages for their operating system. This introduces additional complexity, as we can do the following.</p><pre><code class=language-powershell>wRiTe-HoSt &quot;Hello World!&quot;;
</code></pre><p>In general, this helps malware authors evade detection signatures and decrease readability.</p><h3 id=escape-characters>Escape Characters</h3><p>In PowerShell, methods or functions can be obfuscated with backticks.</p><pre><code class=language-powershell>function e`X`a`M`p`L`e {
	Write-Host &quot;Hello World!&quot;;
}
 e`X`a`M`p`L`e
</code></pre><p>Since they act as escape characters, it does not change the functionality at all.</p><p>However, it does change how tools inspecting the script statically look at them.</p><h2 id=scripting-languages-1>Scripting Languages</h2><p>These are some of the most common scripting languages malware authors use. However, there will always be more. If a scripting language exists, there is probably an obfuscated malicious script waiting to be analyzed.</p><h3 id=jscript>JScript</h3><p>One scripting language malware authors like to take advantage of is Microsoft&rsquo;s JScript, not to be confused with JavaScript. JScript is Microsoft&rsquo;s implementation of the JavaScript engine using the Windows programming interface. Typically, to interact with this programming interface, we use Window&rsquo;s Component Object Model (COM).</p><p>In JScript, access to these objects is created using the following code.</p><pre><code class=language-js>var obj = new ActiveXObject(&quot;Scripting.FileSystemObject&quot;);
</code></pre><p>With this object, we can write to a file by doing the following.</p><pre><code class=language-js>var fobj = obj.CreateTextFile(&quot;hello.txt&quot;, true);
fobj.WriteLine(&quot;Hello World&quot;);
fobj.Close();
</code></pre><p>Further documentation on this COM object and additional methods can be found <a href=https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/filesystemobject-object>here</a>.</p><p>For direct evaluation of code, you will want to look out for the <em>eval</em> function.</p><h3 id=vbscript>VBScript</h3><p>VBScript is another scripting language for Windows, based on Visual Basic and also generally reliant on Window&rsquo;s COM interface. VBScript is defined as follows.</p><blockquote><p>VBScript is an Active Scripting language developed by Microsoft that is modeled on Visual Basic. It allows Microsoft Windows system administrators to generate powerful tools for managing computers with error handling, subroutines, and other advanced programming constructs. - <a href=https://en.wikipedia.org/wiki/VBScript>Wikipedia</a></p></blockquote><p>Now that we have a basic understanding of VBScript, let&rsquo;s perform the same operation as we did with JScript.</p><pre><code class=language-vbscript>Set obj = CreateObject(&quot;Scripting.FileSystemObject&quot;)
Set fobj = fs.CreateTextFile(&quot;c:\testfile.txt&quot;, True)
fobj.WriteLine(&quot;This is a test.&quot;)
fobj.Close
</code></pre><p>For direct evaluation, look out for <em><a href=https://www.vbsedit.com/html/25ebfa26-d3b9-4f82-b3c9-a8568a389dbc.asp>ExecuteGlobal</a></em></p><h3 id=powershell>PowerShell</h3><p>PowerShell is a scripting language and shell included in the Windows operating system by Microsoft.</p><blockquote><p>PowerShell is a task automation and configuration management program from Microsoft, consisting of a command-line shell and the associated scripting language. - <a href=https://en.wikipedia.org/wiki/PowerShell>Wikipedia</a></p></blockquote><p>It is still possible to access COM objects as discussed earlier in this guide. However, it is often not necessary with PowerShell due to the other built-in commands and access to the .NET interpreter.</p><p>When deobfuscating PowerShell, look out for <em>IEX</em> and <em>Invoke-Expression</em>, as these can be used to directly evaluate code.</p><pre><code class=language-powershell>$code = &quot;Write-Host 'Hello World!';&quot;;
Invoke-Expression $code;
</code></pre><p>As with the other direct evaluations, we can simply replace it with something to print to the console, like <em>Write-Host</em>.</p><pre><code class=language-powershell>$code = &quot;Write-Host 'Hello World!';&quot;;
Write-Host $code;
</code></pre><h2 id=conclusion>Conclusion</h2><p>Obfuscation can be a time-consuming task, for myself I think of it like a game of Sudoku. There is enjoyment in creating orderly code and uncovering secrets. When I need a break from reverse engineering, I&rsquo;ll take a task to deobfuscate a script, it always rekindles my joy of this field.</p></article><div class=my-4><a href=https://c3rb3ru5d3d53c.github.io/tags/malware/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#malware</a>
<a href=https://c3rb3ru5d3d53c.github.io/tags/analysis/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#analysis</a>
<a href=https://c3rb3ru5d3d53c.github.io/tags/laboratory/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#laboratory</a>
<a href=https://c3rb3ru5d3d53c.github.io/tags/lab/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#lab</a>
<a href=https://c3rb3ru5d3d53c.github.io/tags/deobfuscation/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#deobfuscation</a>
<a href=https://c3rb3ru5d3d53c.github.io/tags/scripting/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#scripting</a></div><div class=py-2><div class="my-8 flex flex-col items-center md:flex-row"><a href=https://c3rb3ru5d3d53c.github.io/authors/c3rb3ru5d3d53c/ class="md:me-4 text-primary-text h-24 w-24"><img src=https://c3rb3ru5d3d53c.github.io/images/profile.jpg class="bg-primary-bg w-full rounded-full" alt=Avatar></a><div class="mt-4 w-full md:mt-0 md:w-auto"><a href=https://c3rb3ru5d3d53c.github.io/authors/c3rb3ru5d3d53c/ class="mb-2 block border-b pb-1 text-lg font-bold"><h3>c3r3b3ru5d3d53c</h3></a><span class="block pb-2">I have acquired over my career, skills that make me a nightmare for threat actors.</span>
<a href=mailto:c3rb3ru5d3d53c@gmail.com class=me-2><i class="fas fa-envelope"></i></a>
<a href=https://twitter.com/c3rb3ru5d3d53c class=me-2><i class="fab fa-twitter"></i></a>
<a href=https://github.com/c3rb3ru5d3d53c class=me-2><i class="fab fa-github"></i></a>
<a href=https://www.youtube.com/channel/UCk9BugRahSWgPLYOAA3QH4w class=me-2><i class="fab fa-youtube"></i></a></div></div></div><div class="-mx-2 mt-4 flex flex-col border-t px-2 pt-4 md:flex-row md:justify-between"><div></div><div class="mt-4 md:mt-0 md:text-right"><span class="text-primary-text block font-bold">Next</span>
<a href=https://c3rb3ru5d3d53c.github.io/documents/malware-sample-handling/ class=block>Handling Malware Samples</a></div></div></div><div class=col-span-2><div class="bg-primary-bg
prose sticky top-16 z-10 hidden px-6 py-4 lg:block"><h3>On This Page</h3></div><div class="sticky-toc hidden px-6 pb-6 lg:block"><nav id=TableOfContents><ul><li><a href=#prerequisites>Prerequisites</a><ul><li><a href=#scripting-languages>Scripting Languages</a></li><li><a href=#component-object-model-com>Component Object Model (COM)</a></li></ul></li><li><a href=#common-techniques>Common Techniques</a><ul><li><a href=#code-evaluation>Code Evaluation</a></li><li><a href=#comments>Comments</a></li><li><a href=#garbage-code>Garbage Code</a></li><li><a href=#decoding-and-decryption>Decoding and Decryption</a></li><li><a href=#concatenation>Concatenation</a></li><li><a href=#additional-stages>Additional Stages</a></li><li><a href=#upper-and-lower-case>Upper and Lower Case</a></li><li><a href=#escape-characters>Escape Characters</a></li></ul></li><li><a href=#scripting-languages-1>Scripting Languages</a><ul><li><a href=#jscript>JScript</a></li><li><a href=#vbscript>VBScript</a></li><li><a href=#powershell>PowerShell</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><script>window.addEventListener("DOMContentLoaded",()=>{enableStickyToc()})</script></div><div class="bg-secondary-bg prose col-span-2 rounded p-6 lg:col-span-6"><h3>See Also</h3><a href=https://c3rb3ru5d3d53c.github.io/documents/malware-sample-handling/ class=no-underline>Handling Malware Samples</a><br><a href=https://c3rb3ru5d3d53c.github.io/documents/malware-analysis-reversing-workflow/ class=no-underline>Malware Analysis and Reverse Engineering Workflow</a><br><a href=https://c3rb3ru5d3d53c.github.io/documents/malware-analysis-beginner-guide/ class=no-underline>Malware Analysis for Beginners</a><br><a href=https://c3rb3ru5d3d53c.github.io/documents/kvm-malware-lab/ class=no-underline>KVM Malware Lab Guide</a><br><a href=https://c3rb3ru5d3d53c.github.io/malware-blog/2022-07-04-bitter-apt-zxxz-backdoor/ class=no-underline>Making Fun of Your APT Malware - Bitter APT Using ZxxZ Backdoor to Target Pakistan Public Accounts Committee</a><br><a href=https://c3rb3ru5d3d53c.github.io/documents/cheatsheet/ class=no-underline>CheatSheet</a><br></div></div><script>document.addEventListener("DOMContentLoaded",()=>{hljs.highlightAll()})</script></div></div></main><footer class=pl-scrollbar><div class="mx-auto w-full max-w-screen-xl"><div class="text-center p-6 pin-b"><p class="text-sm text-tertiary-text">&copy; 2022 <a href=https://twitter.com/c3rb3ru5d3d53c>c3rb3ru5d3d53c</a>
&#183; Powered by the <a href=https://github.com/wangchucheng/hugo-eureka class=hover:text-eureka>Eureka</a> theme for <a href=https://gohugo.io class=hover:text-eureka>Hugo</a></p></div></div></footer></body></html>