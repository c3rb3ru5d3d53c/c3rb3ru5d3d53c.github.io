
---
title: Reversing Redline Stealer
description: Reversing Redline Stealer Pron Lure
toc: true
authors: c3rb3ru5d3d53c
tags:
  - redline
  - stealer
  - reversing
  - analysis
categories: malware
date: '2022-11-29'
draft: false
---

Muta from `SomeOrdinaryGamers` uploaded a video on Redline Stealer on Aug 14, 2022, which infected Martin Shkreli.

## Infection Chain

The infection chain starts with a download of `[BigTitsRoundAsses] 17.12.14 - Jazmyn [1080p].scr` from `pornleech[.]ch`, which creates three files in the `TEMP%` directory, `Che.mp3` (Autoit Interpreter), `Quella.mp3`, (BAT Script) and `Travolge.mp3` (AutoIT Script).

## Obfuscated BAT Script

Once extracted, the installer executes `cmd /c cmd < Quella.mp3 & ping -n 5 localhost`, which later creates `Mantenga.exe.pif`, which is an AutoIT interpreter.

PLACEHOLDER (FIGURE FOR DEOBFUSCATED THE BAT SCRIPT)

### Obfuscated AutoIT Script

Next, the AutoIT interpreter executes `i`.  Then the AutoIT script performs process hollowing, creates the process `jsc.exe` in suspended mode, hollows the process then injects the process with Redline Stealer.

PLACEHOLDER (ADD FIGURE FOR AU3 DEOBFUSCATOR)

Installer → Quella.mp3 (BAT) → Mantenga.exe.pif (Loader) → jsc.exe

Looks like they are doing process hollowing from the AutoIT script.

```text
CreateProcessW
NtWriteVirtualMemory
NtReadVirtualMemory
NtWriteVirtualMemory
NtProtectVirtualMemory
NtSetContextThread
NtResumeThread
NtUnmapViewOfSection
```

## Redline Stealer

Placeholder

### Initialization

Placeholder

### String Decryption

```python
#!/usr/bin/env python

import base64

def decrypt(ciphertext, key):
    key = key.encode()
    ciphertext = base64.b64decode(ciphertext)
    plaintext = []
    for i in range(0, len(ciphertext)):
        plaintext.append(ciphertext[i] ^ key[i % len(key)])
    plaintext = bytes(plaintext).decode('utf-8')
    return base64.b64decode(plaintext).decode('utf-8')
```

### C2 Communication

Placeholder

### Credential Stealing

Placeholder

## Indicators of Compromise

| Type   | Indicator                                                        | Description                    |
| ------ | ---------------------------------------------------------------- | ------------------------------ |
| SHA256 | 532c47de5bdd433bea776290d27a741b09a1d5c5f2089e54eced922514a60799 | Redline Stealer Installer File |
| SHA256 | 3e8d604a5d545189c35d810845b3e2208e3c56081507b949ecb17a6bbd4decb1 | Messed Up PE File (Che.mp3)    |
| SHA256 | ac5f7f01c7ca6663810df33bfa62012368b6c17b7520943c094308f30adac766 | BAT Script (Quella.mp3)        |
| SHA256 | 454b381e98f092cab4e82f21a790c5ccd4dbd006e44925bcabd6c9289ea6700e | AutoIT Script  (Travolge.mp3)  | 
| SHA256 | 3e26723394ade92f8163b5643960189cb07358b0f96529a477d37176d68aa0a0 | AutoIT Interpreter             |
| SHA256 | 454b381e98f092cab4e82f21a790c5ccd4dbd006e44925bcabd6c9289ea6700e | AutoIT Script                  |
| SHA256 | 676ae4b1ef05ee0ec754a970cce61a5f8d3093989a58c33087a3a5dca06364aa | Redline Stealer (Unpacked)     |

## Detection

This section contains signatures to detect Redline Stealer and its infection chain.

### YARA

Placeholder

### Suricata

Placeholder

## Mitre Attack

| ID          | Tactic      | Technique   |
| ----------- | ----------- | ----------- |
| placeholder | placeholder | placeholder | 
